{"version":3,"file":"ntfyService-DcHFu_a1.js","sources":["../../services/ntfyService.ts"],"sourcesContent":["/**\n * NTFY.SH PUSH NOTIFICATION SERVICE\n * \n * Secure, on-device push notifications using ntfy.sh\n * - Open-source, self-hostable push system\n * - Publish to a topic via HTTP\n * - Receive notifications on Android, iOS, or desktop\n * - Generous free public instance (https://ntfy.sh)\n * - No per-message charge\n * \n * Security: Topics are private by default. Users should use a random topic name.\n * All data remains on-device; only notification text is sent to ntfy.sh.\n */\n\nexport interface NtfyConfig {\n  topic: string;\n  server?: string; // Defaults to https://ntfy.sh\n}\n\n/**\n * Send push notification via ntfy.sh\n * @param message - Notification message text\n * @param title - Notification title (optional)\n * @param config - Ntfy configuration (topic and optional server)\n * @returns Promise<boolean> - Success status\n */\nexport async function sendNtfyNotification(\n  message: string,\n  title: string = 'Grounded',\n  config: NtfyConfig\n): Promise<boolean> {\n  try {\n    const server = config.server || 'https://ntfy.sh';\n    const topic = config.topic.trim();\n    \n    if (!topic) {\n      console.error('Ntfy topic is required');\n      return false;\n    }\n\n    // Validate topic name (alphanumeric, dashes, underscores only)\n    if (!/^[a-zA-Z0-9_-]+$/.test(topic)) {\n      console.error('Invalid ntfy topic name. Use only letters, numbers, dashes, and underscores.');\n      return false;\n    }\n\n    const url = `${server}/${topic}`;\n    \n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'text/plain',\n        'Title': title,\n        'Priority': 'default',\n        'Tags': 'bell,sparkles'\n      },\n      body: message\n    });\n\n    if (!response.ok) {\n      console.error('Ntfy notification failed:', response.status, response.statusText);\n      return false;\n    }\n\n    console.log('Ntfy notification sent successfully');\n    return true;\n  } catch (error) {\n    console.error('Error sending ntfy notification:', error);\n    return false;\n  }\n}\n\n/**\n * Generate a random topic name for privacy\n * Users can use this or create their own\n */\nexport function generateRandomTopic(): string {\n  const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';\n  let topic = 'grounded-';\n  for (let i = 0; i < 12; i++) {\n    topic += chars.charAt(Math.floor(Math.random() * chars.length));\n  }\n  return topic;\n}\n\n/**\n * Validate ntfy topic name\n */\nexport function isValidTopic(topic: string): boolean {\n  if (!topic || topic.length < 1 || topic.length > 64) {\n    return false;\n  }\n  return /^[a-zA-Z0-9_-]+$/.test(topic);\n}\n\n"],"names":["async","sendNtfyNotification","message","title","config","server","topic","trim","test","url","fetch","method","headers","Title","Priority","Tags","body","ok","error","generateRandomTopic","i","charAt","Math","floor","chars","random","isValidTopic","length"],"mappings":"AA0BAA,eAAsBC,EACpBC,EACAC,EAAgB,WAChBC,GAEA,IACE,MAAMC,EAASD,EAAOC,QAAU,kBAC1BC,EAAQF,EAAOE,MAAMC,OAE3B,IAAKD,EAEH,OAAO,EAIT,IAAK,mBAAmBE,KAAKF,GAE3B,OAAO,EAGT,MAAMG,EAAM,GAAGJ,KAAUC,IAazB,eAXuBI,MAAMD,EAAK,CAChCE,OAAQ,OACRC,QAAS,CACP,eAAgB,aAChBC,MAASV,EACTW,SAAY,UACZC,KAAQ,iBAEVC,KAAMd,KAGMe,EAOhB,OAASC,GAEP,OAAO,CACT,CACF,CAMO,SAASC,IAEd,IAAIb,EAAQ,YACZ,IAAA,IAASc,EAAI,EAAGA,EAAI,GAAIA,IACtBd,GAHY,uCAGGe,OAAOC,KAAKC,MAAsBC,GAAhBF,KAAKG,WAExC,OAAOnB,CACT,CAKO,SAASoB,EAAapB,GAC3B,SAAKA,GAASA,EAAMqB,OAAS,GAAKrB,EAAMqB,OAAS,KAG1C,mBAAmBnB,KAAKF,EACjC"}