import{R as e,j as t,r as a}from"./react-vendor-CQK77wC2.js";import{EMOTIONAL_STATES as r,getEmotionalState as s}from"./emotionalStates-BgybEvQ3.js";import{m as l}from"./animations-BWn9_Xek.js";import{h as n}from"./animations-CweKPWyX.js";import{S as i,a as o,b as d,c,d as x}from"./index-C1iKWUY7.js";import{e as m,f as h,h as g,j as p,k as u,l as b}from"./ai-services-Dyqhbvbu.js";import{b as y,s as w}from"./emailService-6vz86vpM.js";import"./vendor-JrpKAf2Q.js";const f=e.memo(({data:e})=>0===e.length?t.jsxs("div",{className:"bg-white dark:bg-dark-bg-secondary rounded-2xl p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-primary dark:text-white mb-4",children:"Mood Trends"}),t.jsx("p",{className:"text-text-secondary dark:text-white/70 text-sm",children:"No mood data available yet. Start logging your reflections to see trends."})]}):t.jsxs("div",{className:"bg-white dark:bg-dark-bg-secondary rounded-2xl p-6 space-y-4 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-primary dark:text-white",children:"Mood Trends"}),t.jsx("div",{className:"space-y-3",children:e.map((e,a)=>t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-xl",children:e.emoji}),t.jsx("span",{className:"text-text-secondary dark:text-white/70",children:e.label})]}),t.jsxs("span",{className:"font-semibold text-text-primary dark:text-white",children:[e.percentage,"%"]})]}),t.jsx("div",{className:"w-full bg-bg-tertiary dark:bg-dark-bg-tertiary rounded-full h-2 overflow-hidden",children:t.jsx(l.div,{initial:{width:0},animate:{width:`${e.percentage}%`},transition:{duration:.5,delay:.1*a},className:"h-full rounded-full",style:{backgroundColor:e.color}})})]},`${e.state}-${a}`))})]})),k=e.memo(({onSelect:e,selected:s,disabled:i=!1})=>{const o=a.useCallback(t=>{i||(n("light"),e(t))},[i,e]);return t.jsxs("div",{className:"space-y-4",children:[t.jsx("h2",{className:"text-xl font-semibold text-text-primary dark:text-white",children:"How are you feeling?"}),t.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-4 lg:grid-cols-8 gap-3",children:r.map((e,a)=>{const r=s===e.state;return t.jsxs(l.button,{onClick:()=>o(e.state),disabled:i,whileTap:{scale:.95},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.05*a},className:`\n                flex flex-col items-center justify-center p-4 sm:p-5 rounded-2xl\n                transition-all duration-200\n                min-h-[88px] min-w-[88px] sm:min-h-[100px] sm:min-w-[100px]\n                ${r?"ring-4 ring-navy-primary dark:ring-yellow-warm shadow-lg scale-105":"shadow-sm hover:shadow-md"}\n                ${i?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n                bg-white dark:bg-dark-bg-secondary\n                border-2 ${r?"border-navy-primary dark:border-yellow-warm":"border-border-soft dark:border-dark-border"}\n              `,children:[t.jsx("div",{className:"w-full h-10 sm:h-12 rounded-lg mb-2 transition-all",style:{backgroundColor:e.color,boxShadow:r?`0 0 0 2px ${e.color}, 0 2px 4px rgba(0,0,0,0.1)`:"none"}}),t.jsx("span",{className:"text-2xl sm:text-3xl mb-1",children:e.emoji}),t.jsx("span",{className:`\n                text-xs sm:text-sm font-semibold text-center leading-tight\n                ${r?"text-navy-primary dark:text-yellow-warm":"text-text-primary dark:text-white/70"}\n              `,children:e.shortLabel})]},e.state)})})]})}),v=e.memo(({message:e,emotion:r,onActionClick:s})=>{const[n,i]=a.useState(!1);a.useEffect(()=>{const e=setTimeout(()=>i(!0),100);return()=>clearTimeout(e)},[]);const o=a.useCallback(e=>{s?.(e)},[s]);return t.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:n?1:0,y:n?0:20},transition:{duration:.5,ease:"easeOut"},className:"bg-navy-light/10 dark:bg-dark-bg-secondary rounded-3xl p-6 space-y-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-8 h-8 bg-navy-primary dark:bg-yellow-warm rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-white dark:text-navy-dark text-sm",children:"ðŸ’™"})}),t.jsx("span",{className:"text-sm font-semibold text-navy-primary dark:text-yellow-warm",children:"AI Reflection"})]}),t.jsx("p",{className:"text-text-primary dark:text-white leading-relaxed",children:e}),s&&t.jsxs("div",{className:"space-y-2 pt-2",children:[t.jsx("p",{className:"text-sm text-text-secondary dark:text-white/70",children:"Would you like to:"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("button",{onClick:()=>o("reflection"),className:"w-full bg-white dark:bg-dark-bg-tertiary text-text-primary dark:text-white rounded-xl p-4 text-left font-medium shadow-sm hover:shadow-md transition-all active:scale-98",children:"ðŸ“ Write a reflection"}),t.jsx("button",{onClick:()=>o("values"),className:"w-full bg-white dark:bg-dark-bg-tertiary text-text-primary dark:text-white rounded-xl p-4 text-left font-medium shadow-sm hover:shadow-md transition-all active:scale-98",children:"ðŸŽ¯ See your values"}),t.jsx("button",{onClick:()=>o("resources"),className:"w-full bg-white dark:bg-dark-bg-tertiary text-text-primary dark:text-white rounded-xl p-4 text-left font-medium shadow-sm hover:shadow-md transition-all active:scale-98",children:"ðŸ“ž View resources"})]})]})]})}),j=({encouragementText:e,encouragementLoading:a,lastEncouragedState:r,lowStateCount:s,lcswConfig:l,values:n,onSelectEmotion:o,onActionClick:d,onResetEncouragement:c,onOpenFirstValue:x})=>t.jsxs("div",{className:"bg-white dark:bg-dark-bg-secondary rounded-xl sm:rounded-2xl border border-border-soft dark:border-dark-border shadow-sm p-4 sm:p-5",children:[!e&&t.jsx(k,{onSelect:o,selected:r,disabled:a}),e&&t.jsxs("div",{className:"space-y-4",children:[t.jsx(v,{message:e,emotion:r||void 0,onActionClick:e=>{"reflection"===e?x():d(e)}}),s>=3&&("drained"===r||"heavy"===r||"overwhelmed"===r)&&t.jsx("div",{className:"mt-3 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800",children:t.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium",children:["ðŸ’™ ",t.jsx("strong",{children:"Consider reaching out:"})," You've been feeling low several times. Your therapist (",l?.emergencyContact?.phone||"contact them","), a trusted friend, or the 988 Crisis & Suicide Lifeline can provide support. You don't have to go through this alone."]})}),t.jsx("button",{onClick:c,className:"w-full py-2 text-sm text-text-secondary dark:text-white/70 hover:text-text-primary dark:hover:text-white transition-colors",children:"Choose a different feeling"})]}),a&&t.jsx("div",{className:"space-y-3",children:t.jsx(i,{lines:2,showHeader:!0})})]}),N=({value:e,emotionalState:a,selectedFeeling:l,showFeelingsList:n,reflectionText:i,goalText:d,goalFreq:c,reflectionAnalysis:x,analyzingReflection:m,coachInsight:h,valueMantra:g,loading:p,aiGoalLoading:u,lcswConfig:b,onEmotionalStateChange:y,onShowFeelingsListToggle:w,onSelectedFeelingChange:f,onReflectionTextChange:k,onGoalTextChange:v,onGoalFreqChange:j,onSuggestGoal:N,onCommit:C,getReflectionPlaceholder:S})=>t.jsxs("div",{className:"mt-4 sm:mt-6 space-y-4 sm:space-y-6 animate-pop border-t border-border-soft dark:border-dark-border/30 pt-4 sm:pt-5",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("label",{className:"text-[8px] font-black text-text-primary/50 dark:text-white/50 uppercase tracking-widest block px-1",children:"How are you feeling right now?"}),t.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-4 lg:grid-cols-8 gap-1.5 sm:gap-2",children:r.map(e=>{const r=a===e.state;return t.jsxs("button",{onClick:()=>{y(e.state),w()},className:"flex flex-col items-center p-2 sm:p-3 rounded-lg sm:rounded-xl border-2 transition-all active:scale-95 "+(r?"border-navy-primary dark:border-white shadow-md scale-105 bg-white dark:bg-dark-bg-primary":"border-border-soft dark:border-dark-border/30 hover:border-border-soft dark:hover:border-dark-border/50 bg-white dark:bg-dark-bg-primary"),children:[t.jsx("div",{className:"w-full h-8 sm:h-10 rounded-md mb-1.5 sm:mb-2 transition-all",style:{backgroundColor:e.color,boxShadow:r?`0 0 0 2px ${e.color}, 0 2px 4px rgba(0,0,0,0.1)`:"none"}}),t.jsx("span",{className:"text-[7px] sm:text-[8px] font-black uppercase tracking-tight text-center leading-tight "+(r?"text-text-primary dark:text-white":"text-text-primary/60 dark:text-white/60"),children:e.shortLabel})]},e.state)})}),n&&(()=>{const e=s(a);return e?t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-navy-dark/60 backdrop-blur-sm",onClick:w,children:t.jsx("div",{className:"bg-white dark:bg-dark-bg-primary rounded-2xl sm:rounded-3xl shadow-2xl max-w-md w-full max-h-[80vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:t.jsxs("div",{className:"p-4 sm:p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg sm:text-xl font-black text-text-primary dark:text-white",children:e.label}),t.jsx("p",{className:"text-xs text-text-primary/60 dark:text-white/60 mt-1",children:e.reflectionPrompt})]}),t.jsx("button",{onClick:w,className:"w-8 h-8 flex items-center justify-center rounded-full bg-bg-secondary dark:bg-dark-bg-primary/50 text-text-tertiary hover:text-text-primary dark:hover:text-white",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3",children:e.feelings.map(a=>t.jsx("button",{onClick:()=>{f(a),w()},className:"p-3 sm:p-4 rounded-xl sm:rounded-2xl border-2 transition-all active:scale-95 "+(l===a?"border-navy-primary dark:border-white font-bold text-white dark:text-text-primary":"border-border-soft dark:border-dark-border/30 bg-bg-secondary dark:bg-dark-bg-primary/50 text-text-primary dark:text-white hover:border-yellow-warm/50"),style:l===a?{backgroundColor:e.color}:{},children:t.jsx("span",{className:"text-xs sm:text-sm capitalize",children:a})},a))}),l&&t.jsx("div",{className:"mt-4 p-3 bg-yellow-warm/10 dark:bg-yellow-warm/20 rounded-xl border border-yellow-warm/30",children:t.jsxs("p",{className:"text-xs text-text-primary dark:text-white",children:[t.jsx("span",{className:"font-bold",children:"Selected:"})," ",l]})})]})})}):null})(),l&&(()=>{const e=s(a);return e?t.jsx("div",{className:"mt-2 p-2 sm:p-3 bg-yellow-warm/10 dark:bg-yellow-warm/20 rounded-lg border border-yellow-warm/30",children:t.jsxs("p",{className:"text-[9px] sm:text-[10px] text-text-primary dark:text-white",children:[t.jsx("span",{className:"font-bold",children:"Feeling:"})," ",l," (",e.shortLabel,")"]})}):null})()]}),t.jsxs("div",{className:"bg-navy-primary dark:bg-navy-primary rounded-xl sm:rounded-2xl p-3 sm:p-4 shadow-md border border-navy-primary/20 dark:border-dark-border/50 relative overflow-hidden group",children:[t.jsx("p",{className:"text-[7px] font-black text-yellow-warm/80 uppercase tracking-widest mb-1.5",children:"Focus Lens"}),p?t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(o,{width:"75%",height:"0.625rem",className:"bg-yellow-warm/30"}),t.jsx(o,{width:"50%",height:"0.625rem",className:"bg-yellow-warm/30"})]}):t.jsxs("p",{className:"text-white dark:text-white font-medium italic text-[11px] sm:text-xs leading-relaxed relative z-10",children:['"',h,'"']}),t.jsx("div",{className:"absolute bottom-2 right-3 sm:right-4 text-[7px] sm:text-[8px] font-black text-yellow-warm/60 uppercase opacity-60",children:g})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between px-1",children:[t.jsx("label",{className:"text-[8px] font-black text-text-primary/50 dark:text-white/50 uppercase tracking-widest",children:"1. Deep Reflection"}),t.jsx("span",{className:"text-[8px] font-bold text-yellow-warm uppercase tracking-widest",children:"Systemic Focus"})]}),t.jsx("textarea",{value:i,onChange:e=>k(e.target.value),placeholder:S(c),className:"w-full p-3 sm:p-4 rounded-xl sm:rounded-2xl bg-bg-secondary dark:bg-dark-bg-primary/50 border-none focus:ring-2 focus:ring-yellow-warm/30 outline-none text-text-primary dark:text-white min-h-[140px] sm:min-h-[160px] resize-none text-[10px] sm:text-[11px] leading-relaxed shadow-inner"}),m&&t.jsx("div",{className:"text-[8px] text-yellow-warm font-bold uppercase tracking-widest animate-pulse",children:"Analyzing reflection..."}),x&&!m&&t.jsxs("div",{className:"mt-3 p-3 sm:p-4 bg-yellow-warm/10 dark:bg-yellow-warm/20 rounded-xl border border-yellow-warm/30 space-y-3",children:[t.jsx("div",{className:"text-[8px] font-black text-yellow-warm uppercase tracking-widest",children:"Reflection Analysis"}),t.jsx("div",{className:"text-[9px] sm:text-[10px] text-text-primary dark:text-white whitespace-pre-line leading-relaxed space-y-2",children:x.split("\n").map((e,a)=>e.startsWith("##")?t.jsx("div",{className:"font-black text-yellow-warm mt-3 first:mt-0",children:e.replace("##","").trim()},a):e.startsWith("-")||/^\d+\./.test(e.trim())?t.jsx("div",{className:"ml-2",children:e},a):e.trim()?t.jsx("div",{children:e},a):t.jsx("br",{},a))})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center px-1",children:[t.jsx("label",{className:"text-[8px] font-black text-text-primary/50 dark:text-white/50 uppercase tracking-widest",children:"2. Self-Advocacy Aim"}),t.jsx("button",{onClick:N,disabled:u,className:"text-[8px] font-black text-yellow-warm uppercase tracking-widest hover:underline disabled:opacity-50",children:u?"Suggesting...":"âœ¨ Suggest"})]}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx("div",{className:"flex gap-1",children:["daily","weekly","monthly"].map(e=>t.jsx("button",{onClick:()=>j(e),className:"flex-1 py-1 rounded-lg text-[7px] font-black uppercase tracking-widest transition-all "+(c===e?"bg-yellow-warm text-text-primary shadow-sm":"bg-bg-secondary dark:bg-dark-bg-primary/50 text-text-primary/40 dark:text-white/40"),children:e},e))}),t.jsx("textarea",{value:d,onChange:e=>v(e.target.value),placeholder:"Define one tool or boundary to implement next.",className:"w-full p-3 sm:p-4 rounded-xl sm:rounded-2xl bg-bg-secondary dark:bg-dark-bg-primary/50 border-none focus:ring-2 focus:ring-yellow-warm/30 outline-none text-text-primary dark:text-white min-h-[100px] sm:min-h-[120px] resize-none text-[10px] sm:text-[11px] leading-relaxed shadow-inner"})]})]})]}),t.jsx("button",{onClick:C,disabled:!i.trim()&&!d.trim(),className:"w-full py-3 sm:py-4 bg-yellow-warm text-text-primary rounded-xl sm:rounded-2xl font-black uppercase tracking-[0.2em] shadow-lg hover:opacity-90 transition-all active:scale-[0.98] disabled:opacity-20 text-[9px] sm:text-[10px]",children:"Archive & Commit"})]}),C=e.memo(({value:e,index:a,isActive:r,isSuccess:s,valueGoals:l,emotionalState:n,selectedFeeling:i,showFeelingsList:o,reflectionText:d,goalText:c,goalFreq:x,reflectionAnalysis:m,analyzingReflection:h,coachInsight:g,valueMantra:p,loading:u,aiGoalLoading:b,cardRef:y,onToggleActive:w,onEmotionalStateChange:f,onShowFeelingsListToggle:k,onSelectedFeelingChange:v,onReflectionTextChange:j,onGoalTextChange:C,onGoalFreqChange:S,onSuggestGoal:T,onCompleteGoal:F,onCommit:L,getReflectionPlaceholder:G,lcswConfig:E})=>t.jsx("div",{ref:y,className:`bg-white dark:bg-dark-bg-primary rounded-xl sm:rounded-2xl border transition-all duration-300 ${r?"border-yellow-warm shadow-lg dark:shadow-xl":"border-border-soft dark:border-dark-border/30 shadow-sm hover:border-yellow-warm/50 dark:hover:border-yellow-warm/50"} ${s?"border-calm-sage dark:border-calm-sage ring-2 ring-calm-sage/20 dark:ring-calm-sage/30":""}`,children:t.jsxs("div",{className:"p-3 sm:p-4 md:p-5",children:[t.jsxs("div",{className:"flex items-center justify-between gap-2 sm:gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-grow min-w-0",children:[t.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center text-[10px] sm:text-xs font-black shadow-sm flex-shrink-0 "+(0===a?"bg-yellow-warm text-text-primary":"bg-bg-secondary dark:bg-dark-bg-primary/50 text-text-primary/40 dark:text-white/40"),children:a+1}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h3",{className:"text-sm sm:text-base font-black text-text-primary dark:text-white tracking-tight truncate",children:e.name}),t.jsx("p",{className:"text-[7px] font-bold text-text-primary/50 dark:text-white/50 uppercase tracking-widest",children:e.category})]})]}),t.jsxs("button",{onClick:w,className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg sm:rounded-xl font-black text-[8px] sm:text-[9px] uppercase tracking-widest transition-all shadow-sm active:scale-95 flex-shrink-0 "+(r?"bg-navy-primary dark:bg-navy-primary text-white":"bg-yellow-warm text-text-primary hover:opacity-90"),children:[t.jsx("span",{className:"hidden sm:inline",children:r?"Close":"Check-in"}),t.jsx("span",{className:"sm:hidden",children:r?"âœ•":"âœ“"})]})]}),!r&&l.length>0&&t.jsx("div",{className:"mt-3 pt-3 border-t border-border-soft dark:border-dark-border/30 flex gap-2 overflow-x-auto no-scrollbar pb-1",children:l.map(e=>t.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2 bg-bg-secondary dark:bg-dark-bg-primary/50 px-2 sm:px-3 py-1.5 rounded-lg sm:rounded-xl border border-border-soft dark:border-dark-border/30",children:[t.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold text-text-primary dark:text-white max-w-[100px] sm:max-w-[120px] truncate",children:e.text}),t.jsx("button",{onClick:()=>F(e),className:"w-5 h-5 bg-calm-sage dark:bg-calm-sage text-white rounded-md flex items-center justify-center shadow-sm active:scale-90 flex-shrink-0",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M5 13l4 4L19 7"})})})]},e.id))}),r&&t.jsx(N,{value:e,emotionalState:n,selectedFeeling:i,showFeelingsList:o,reflectionText:d,goalText:c,goalFreq:x,reflectionAnalysis:m,analyzingReflection:h,coachInsight:g,valueMantra:p,loading:u,aiGoalLoading:b,lcswConfig:E,onEmotionalStateChange:f,onShowFeelingsListToggle:k,onSelectedFeelingChange:v,onReflectionTextChange:j,onGoalTextChange:C,onGoalFreqChange:S,onSuggestGoal:T,onCommit:L,getReflectionPlaceholder:G})]})})),S=e.memo(({goals:e,values:a,onCompleteGoal:r,onDeleteGoal:s})=>{const l=e.filter(e=>!e.completed);return 0===l.length?null:t.jsxs("div",{className:"space-y-3 pt-4 sm:pt-6 border-t border-border-soft dark:border-dark-border/30",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-sm sm:text-base font-black text-text-primary dark:text-white tracking-tight",children:"Active Commitments"}),t.jsx("p",{className:"text-[8px] font-black text-text-primary/50 dark:text-white/50 uppercase tracking-widest",children:'The "Work"'})]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:l.map(e=>{const l=a.find(t=>t.id===e.valueId);return t.jsxs("div",{className:"bg-white dark:bg-dark-bg-primary p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-border-soft dark:border-dark-border/30 shadow-sm relative",children:[t.jsx("span",{className:"absolute top-2 sm:top-3 right-3 sm:right-4 px-1.5 py-0.5 bg-yellow-warm/20 dark:bg-yellow-warm/30 text-yellow-warm rounded-md text-[6px] font-black uppercase tracking-widest",children:e.frequency}),t.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[t.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-yellow-warm"}),t.jsx("span",{className:"text-[8px] font-black text-text-primary/50 dark:text-white/50 uppercase tracking-widest",children:l?.name})]}),t.jsx("div",{className:"text-[10px] sm:text-[11px] font-bold text-text-primary dark:text-white mb-3 sm:mb-4 leading-snug pr-12",children:e.text}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>r(e),className:"flex-1 py-2 bg-calm-sage dark:bg-calm-sage text-white rounded-lg text-[9px] font-black uppercase tracking-widest shadow-sm hover:opacity-90",children:"Done"}),t.jsx("button",{onClick:()=>s(e.id),className:"w-8 h-8 bg-bg-secondary dark:bg-dark-bg-primary/50 text-text-primary/30 dark:text-white/30 rounded-lg hover:text-red-500 dark:hover:text-red-400 flex items-center justify-center transition-colors",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})]})]},e.id)})})]})}),T=({onClose:e,lcswConfig:a})=>t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6 bg-navy-dark/60 backdrop-blur-sm animate-fade-in",onClick:e,children:t.jsxs("div",{className:"bg-white dark:bg-dark-bg-primary w-full max-w-lg rounded-[40px] shadow-2xl overflow-hidden animate-pop relative border border-border-soft dark:border-dark-border",onClick:e=>e.stopPropagation(),children:[t.jsx("button",{onClick:e,className:"absolute top-6 right-6 w-10 h-10 flex items-center justify-center rounded-full bg-bg-secondary dark:bg-dark-bg-secondary text-text-tertiary dark:text-text-tertiary hover:text-text-primary dark:hover:text-white transition-colors z-10",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}),t.jsxs("div",{className:"p-8 sm:p-10 space-y-6 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"text-center space-y-2",children:[t.jsx("div",{className:"text-4xl mb-2",children:"ðŸ“ž"}),t.jsx("h2",{className:"text-2xl sm:text-3xl font-black text-text-primary dark:text-white tracking-tight",children:"Crisis Resources"}),t.jsx("p",{className:"text-sm sm:text-base text-text-primary/60 dark:text-white/60",children:"You're not alone. Help is available 24/7."})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500 p-4 sm:p-5 rounded-xl",children:[t.jsx("h3",{className:"text-lg font-black text-red-800 dark:text-red-300 mb-2",children:"ðŸš¨ Emergency Services"}),t.jsxs("div",{className:"space-y-2 text-sm text-red-700 dark:text-red-200",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"911"})," - For immediate emergencies"]}),t.jsx("p",{className:"text-xs text-red-600 dark:text-red-300",children:"Call 911 if you or someone else is in immediate danger."})]})]}),t.jsxs("div",{className:"bg-yellow-warm/10 dark:bg-yellow-warm/20 border-l-4 border-yellow-warm p-4 sm:p-5 rounded-xl",children:[t.jsx("h3",{className:"text-lg font-black text-text-primary dark:text-white mb-3",children:"ðŸ“ž Crisis Hotlines (24/7, Free, Confidential)"}),t.jsxs("div",{className:"space-y-3 text-sm text-text-primary dark:text-white",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-bold text-base",children:"988 Suicide & Crisis Lifeline"}),t.jsxs("p",{className:"text-xs text-text-secondary dark:text-text-secondary mt-1",children:["Dial ",t.jsx("strong",{children:"988"})," or text 988. Available 24/7 for anyone in suicidal crisis or emotional distress."]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"font-bold text-base",children:"Crisis Text Line"}),t.jsxs("p",{className:"text-xs text-text-secondary dark:text-text-secondary mt-1",children:["Text ",t.jsx("strong",{children:"HOME"})," to ",t.jsx("strong",{children:"741741"}),". Free, 24/7 crisis support via text message."]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"font-bold text-base",children:"National Domestic Violence Hotline"}),t.jsxs("p",{className:"text-xs text-text-secondary dark:text-text-secondary mt-1",children:["Call ",t.jsx("strong",{children:"1-800-799-SAFE (7233)"})," or text START to 88788. 24/7 support for domestic violence."]})]})]})]}),a?.emergencyContact?.phone&&t.jsxs("div",{className:"bg-navy-primary/10 dark:bg-navy-primary/20 border-l-4 border-navy-primary p-4 sm:p-5 rounded-xl",children:[t.jsx("h3",{className:"text-lg font-black text-text-primary dark:text-white mb-2",children:"ðŸ‘¤ Your Therapist"}),t.jsxs("div",{className:"space-y-2 text-sm text-text-primary dark:text-white",children:[a.emergencyContact.phone&&t.jsxs("p",{children:[t.jsx("strong",{children:"Phone:"})," ",a.emergencyContact.phone]}),a.emergencyContact.email&&t.jsxs("p",{children:[t.jsx("strong",{children:"Email:"})," ",a.emergencyContact.email]}),a.emergencyContact.name&&t.jsxs("p",{className:"text-xs text-text-secondary dark:text-text-secondary mt-1",children:["Contact: ",a.emergencyContact.name]})]})]}),t.jsx("div",{className:"bg-bg-secondary dark:bg-dark-bg-secondary p-4 sm:p-5 rounded-xl border border-border-soft dark:border-dark-border",children:t.jsxs("p",{className:"text-xs text-text-secondary dark:text-text-secondary leading-relaxed",children:[t.jsx("strong",{children:"Remember:"})," These resources are available 24/7. If you're in crisis, don't wait - reach out immediately. Your safety and wellbeing are important."]})})]}),t.jsx("div",{className:"pt-4",children:t.jsx("button",{onClick:e,className:"w-full py-4 bg-navy-primary dark:bg-navy-primary text-white dark:text-white rounded-[24px] font-black uppercase tracking-[0.2em] shadow-xl hover:opacity-90 transition-all active:scale-[0.98]",children:"Got it"})})]})]})});function F(e,t){const[r,s]=a.useState(e);return a.useEffect(()=>{const a=setTimeout(()=>{s(e)},t);return()=>{clearTimeout(a)}},[e,t]),r}const L=e.memo(({values:e,onLog:l,goals:n,onUpdateGoals:i,logs:o,lcswConfig:k,onNavigate:v})=>{const N=function(e,t,r,s,l,n){const[i,o]=a.useState(null),[f,k]=a.useState(!1),[v,j]=a.useState(null),[N,C]=a.useState("âœ¨"),[S,T]=a.useState("mixed"),[L,G]=a.useState(null),[E,R]=a.useState(!1),A=F(N,500),[I,D]=a.useState(""),[$,M]=a.useState(""),[W,H]=a.useState("daily"),[q,P]=a.useState(!1),[V,z]=a.useState(null),[_,Y]=a.useState(null),[O,B]=a.useState(null),[U,J]=a.useState(!1),[K,Q]=a.useState(null),[X,Z]=a.useState(!1),[ee,te]=a.useState(null),[ae,re]=a.useState(0),se=F(I,2e3),le=a.useRef({});a.useEffect(()=>{i&&Promise.all([d(`draft_reflection_${i}`),d(`draft_goal_${i}`)]).then(([e,t])=>{e&&D(e),t&&M(t)}).catch(console.error)},[i]),a.useEffect(()=>{i&&(c(`draft_reflection_${i}`,I).catch(console.error),c(`draft_goal_${i}`,$).catch(console.error))},[I,$,i]),a.useEffect(()=>{se.trim()&&i?(J(!0),m(se,W,s).then(e=>{B(e),J(!1)}).catch(e=>{B(null),J(!1)})):B(null)},[se,W,i,s]),a.useEffect(()=>{if(i){const t=e.find(e=>e.id===i);t&&(k(!0),Promise.all([h(t,A,s),g(t)]).then(([e,t])=>{z(e),Y(t),k(!1)}).catch(e=>{z("There was an issue connecting to the AI coach. Focusing on the present moment is a powerful step."),Y("Be Here Now"),k(!1)}))}else z(null)},[A,i,e,s]);const[ne,ie]=a.useState(null);a.useEffect(()=>{if(e.length>0&&!ne){const t=e[0];g(t).then(e=>ie(e)).catch(()=>ie("Be Here Now"))}},[e,ne]),a.useEffect(()=>{i&&le.current[i]&&setTimeout(()=>{le.current[i]?.scrollIntoView({behavior:"smooth",block:"center"})},100)},[i]);const oe=a.useCallback(e=>{const t=["The Hour: Dominant mood 'flavor'? Thought, person, or sensation triggered it?","The Day: When did I feel 'connected' vs 'checked out'?","Daily Win: One small boundary set or self-care moment followed through?","Energy Audit: What interaction drained the battery? How to recharge?"].join("\n\n"),a=["The Narrative: If this week was a book chapter, what would the title be?","Coping Check: Which therapy tools felt like life jackets? Which felt like anchors?","Social Environment: How did my body feel after leaving specific social spaces?","Unfinished Business: What am I still 'chewing on' or feeling heavy about?"].join("\n\n"),r=["Growth Marker: What feels slightly less daunting than it did 30 days ago?","Recurring Theme: What 'broken record' thought kept appearing? What is it saying?","External Impact: How have systemic factors (finances, work) influenced me?","Goal Alignment: Am I moving toward my treatment plan version of self?"].join("\n\n");return"weekly"===e?a:"monthly"===e||"quarterly"===e?r:t},[]),de=a.useCallback(async e=>{P(!0);try{const t=p(I,s);if(t.isCrisis&&"continue"!==t.recommendedAction)return M(`### Safety First\n\nâš ï¸ Your reflection contains concerning content. Please contact your therapist or emergency services if needed.\n\nEmergency: ${s?.emergencyContact?.phone||"911"}\nCrisis Line: 988`),void P(!1);const a=I.trim()?`Deep Reflection:\n${I}\n\n${O?`Reflection Analysis:\n${O}`:""}`:O||"",r=await u(e,W,a,s);M(r)}catch(t){M("Error suggesting a goal. Try writing a small, simple one yourself!")}finally{P(!1)}},[I,O,W,s]),ce=a.useCallback(async a=>{const r={...a,completed:!0};if(l({id:Date.now().toString()+"-done",date:(new Date).toISOString(),valueId:a.valueId,livedIt:!0,note:`Achieved Commitment: ${a.text.substring(0,40)}...`,type:"goal-completion",goalText:a.text}),n(t.map(e=>e.id===a.id?r:e)),s?.emergencyContact?.phone||s?.emergencyContact){const t=y([],e,[r]),a=[];await w(t,a)}},[t,e,s,l,n]),xe=a.useCallback(e=>{n(t.filter(t=>t.id!==e))},[t,n]),me=a.useCallback(async e=>{let t;Z(!0),te(e),Q(null),"drained"===e||"heavy"===e||"overwhelmed"===e?(t=ae+1,re(t)):(t=0,re(0));const a=(new Date).getHours(),l=a<12?"morning":a<18?"afternoon":a<22?"evening":"night",n=r.slice(0,3).map(e=>e.note||e.deepReflection||"").filter(Boolean).join(" ").substring(0,500);try{const a=await b(e,L,t,s,{recentJournalText:n||void 0,timeOfDay:l,userPatterns:{frequentStates:[],progress:0}});Q(a)}catch(i){Q("You're doing important work. Keep going, one step at a time.")}finally{Z(!1)}},[r,L,ae,s]),he=a.useCallback(e=>{if(!I.trim()&&!$.trim())return;const a=`${I} ${$}`.trim(),r=p(a);r.isCrisis&&"critical"===r.severity&&alert(`ðŸš¨ CRISIS DETECTED\n\nYour entry contains crisis indicators. Please:\n\n1. Contact emergency services: 911\n2. Contact your therapist: ${s?.emergencyContact?.phone||"Your therapist's emergency line"}\n3. Crisis hotline: 988\n\nThis app cannot provide crisis support. Please connect with a professional immediately.`);const i=(new Date).toISOString();if($.trim()){const a={id:Date.now().toString()+"-goal",valueId:e,text:$,frequency:W,completed:!1,createdAt:i,updates:[]};n([a,...t])}l({id:Date.now().toString()+"-log",date:i,valueId:e,livedIt:!0,note:I.trim()||"Observed without judgment.",mood:N,type:$.trim()?"goal-update":"standard",goalText:$.trim()||void 0,deepReflection:I.trim()||void 0,reflectionAnalysis:O||void 0,emotionalState:S,selectedFeeling:L||void 0}),T("mixed"),G(null),x(`draft_reflection_${e}`).catch(console.error),x(`draft_goal_${e}`).catch(console.error),j(e),setTimeout(()=>j(null),2e3),D(""),M(""),z(null),Y(null),o(null)},[I,$,W,S,L,N,O,s,t,l,n]);return{activeValueId:i,loading:f,lastLoggedId:v,emotionalState:S,selectedFeeling:L,showFeelingsList:E,reflectionText:I,goalText:$,goalFreq:W,aiGoalLoading:q,coachInsight:V,valueMantra:_,reflectionAnalysis:O,analyzingReflection:U,encouragementText:K,encouragementLoading:X,lastEncouragedState:ee,lowStateCount:ae,topValueMantra:ne,valueCardRefs:le,setActiveValueId:o,setEmotionalState:T,setSelectedFeeling:G,setShowFeelingsList:R,setReflectionText:D,setGoalText:M,setGoalFreq:H,handleSuggestGoal:de,handleCompleteGoal:ce,handleDeleteGoal:xe,handleEmotionalEncourage:me,handleCommit:he,getReflectionPlaceholder:oe,resetEncouragement:a.useCallback(()=>{Q(null),te(null)},[])}}(e,n,o,k,l,i),[L,G]=a.useState(!1),E=a.useMemo(()=>{if(0===o.length)return[];const e=new Date;e.setDate(e.getDate()-7);const t=o.filter(t=>new Date(t.date)>=e),a={};t.forEach(e=>{e.emotionalState&&(a[e.emotionalState]=(a[e.emotionalState]||0)+1)});const s=t.length||1;return r.map(e=>{const t=a[e.state]||0;return{state:e.state,emoji:e.emoji,label:e.shortLabel,percentage:Math.round(t/s*100),color:e.color}}).filter(e=>e.percentage>0).sort((e,t)=>t.percentage-e.percentage).slice(0,4)},[o]),R=e.length>0?e[0]:null,A=N.valueMantra||N.topValueMantra||"Be Here Now";return t.jsxs("div",{className:"space-y-4 sm:space-y-6 animate-fade-in pb-20 lg:pb-12",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary dark:text-white",children:[(()=>{const e=(new Date).getHours();return e<12?"Good morning":e<18?"Good afternoon":"Good evening"})()," ",(()=>{const e=(new Date).getHours();return e<12?"ðŸŒ…":e<18?"â˜€ï¸":"ðŸŒ™"})()]}),t.jsx("p",{className:"text-text-secondary dark:text-white/70",children:"How are you feeling today?"})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-0",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg sm:text-xl font-black text-text-primary dark:text-white tracking-tight",children:"Compass Engine"}),t.jsx("p",{className:"text-[9px] font-black text-text-primary/50 dark:text-white/50 uppercase tracking-widest",children:"Observe & Document"})]}),t.jsxs("div",{className:"text-left sm:text-right",children:[t.jsx("p",{className:"text-[9px] font-black text-yellow-warm uppercase tracking-widest",children:"Active Focus"}),t.jsxs("p",{className:"text-sm sm:text-base font-black text-text-primary dark:text-white leading-tight",children:[e.length," Core Values"]})]})]}),t.jsx(j,{encouragementText:N.encouragementText,encouragementLoading:N.encouragementLoading,lastEncouragedState:N.lastEncouragedState,lowStateCount:N.lowStateCount,lcswConfig:k,values:e,onSelectEmotion:N.handleEmotionalEncourage,onActionClick:t=>{"reflection"===t?e.length>0&&N.setActiveValueId(e[0].id):"values"===t?v&&v("values"):"resources"===t&&G(!0)},onResetEncouragement:N.resetEncouragement,onOpenFirstValue:()=>{e.length>0&&N.setActiveValueId(e[0].id)}}),E.length>0&&t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-primary dark:text-white",children:"ðŸ“Š Your Week at a Glance"}),t.jsx(f,{data:E})]}),R&&t.jsxs("div",{className:"bg-gradient-to-br from-yellow-warm/20 to-yellow-light/20 dark:from-yellow-warm/10 dark:to-yellow-light/10 rounded-2xl p-6 space-y-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-2xl",children:"ðŸŽ¯"}),t.jsx("h3",{className:"text-lg font-semibold text-text-primary dark:text-white",children:"Today's Focus"})]}),t.jsx("p",{className:"text-text-primary dark:text-white font-medium",children:R.name}),t.jsxs("p",{className:"text-text-secondary dark:text-white/70 italic",children:['"',A,'"']})]}),o.length>0&&t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-primary dark:text-white",children:"âœ¨ Recent Reflections"}),t.jsx("div",{className:"space-y-2",children:o.slice(0,3).map(a=>{const r=new Date(a.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),l=e.find(e=>e.id===a.valueId),n=a.emotionalState?s(a.emotionalState):null,i=n?n.emoji:"ðŸ“";return t.jsxs("div",{className:"bg-white dark:bg-dark-bg-secondary rounded-xl p-4 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-text-secondary dark:text-white/70",children:r}),t.jsx("span",{className:"text-xl",children:i})]}),t.jsx("p",{className:"text-text-primary dark:text-white line-clamp-2 text-sm",children:a.note||a.deepReflection||"Reflection entry"}),l&&t.jsx("p",{className:"text-xs text-text-tertiary dark:text-white/50 mt-1",children:l.name})]},a.id)})})]}),t.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.map((a,r)=>{const s=N.activeValueId===a.id,l=N.lastLoggedId===a.id,i=n.filter(e=>e.valueId===a.id&&!e.completed),o=e.find(e=>e.id===N.activeValueId);return t.jsx(C,{value:a,index:r,isActive:s,isSuccess:l,valueGoals:i,emotionalState:N.emotionalState,selectedFeeling:N.selectedFeeling,showFeelingsList:N.showFeelingsList,reflectionText:N.reflectionText,goalText:N.goalText,goalFreq:N.goalFreq,reflectionAnalysis:N.reflectionAnalysis,analyzingReflection:N.analyzingReflection,coachInsight:N.coachInsight,valueMantra:N.valueMantra,loading:N.loading,aiGoalLoading:N.aiGoalLoading,cardRef:e=>{N.valueCardRefs.current[a.id]=e},onToggleActive:()=>{s&&(N.setEmotionalState("mixed"),N.setSelectedFeeling(null),N.setShowFeelingsList(!1)),N.setActiveValueId(s?null:a.id)},onEmotionalStateChange:e=>N.setEmotionalState(e),onShowFeelingsListToggle:()=>N.setShowFeelingsList(!N.showFeelingsList),onSelectedFeelingChange:e=>N.setSelectedFeeling(e),onReflectionTextChange:e=>N.setReflectionText(e),onGoalTextChange:e=>N.setGoalText(e),onGoalFreqChange:e=>N.setGoalFreq(e),onSuggestGoal:()=>o&&N.handleSuggestGoal(o),onCompleteGoal:N.handleCompleteGoal,onCommit:()=>N.handleCommit(a.id),getReflectionPlaceholder:N.getReflectionPlaceholder,lcswConfig:k},a.id)})}),t.jsx(S,{goals:n,values:e,onCompleteGoal:N.handleCompleteGoal,onDeleteGoal:N.handleDeleteGoal}),L&&t.jsx(T,{onClose:()=>G(!1),lcswConfig:k})]})});export{L as default};
//# sourceMappingURL=Dashboard-C2MrqrfV.js.map
