var G=Object.defineProperty;var a=(d,l)=>G(d,"name",{value:l,configurable:!0});import{r as i,j as e}from"./react-vendor-ByHOp49b.js";import{b as U,s as D}from"./emailService-BJmZKHwj.js";import{S as E}from"./StatusIndicator-CNI75ZVz.js";import"./vendor-CFU3Mex3.js";import"./transformers-CgLRIXTl.js";import"@tauri-apps/api/core";import"./ai-services-4hnf0_d4.js";const T=a(({goals:d,values:l,lcswConfig:g,onUpdateGoal:y,onCompleteGoal:j,onDeleteGoal:v})=>{const[o,n]=i.useState(null),[c,m]=i.useState(""),[x,p]=i.useState(void 0),[h,u]=i.useState(!1),[f,k]=i.useState(!1),w=d.filter(t=>!t.completed),s=o?d.find(t=>t.id===o):null,N=a(async()=>{if(!(!s||!c.trim())){u(!0);try{const t={id:Date.now().toString()+"-update",timestamp:new Date().toISOString(),note:c.trim(),mood:x};y(s.id,t),k(!0),setTimeout(()=>k(!1),3e3),m(""),p(void 0),n(null)}catch(t){console.error("Error updating goal:",t)}finally{u(!1)}}},"handleUpdateGoal"),S=a(async t=>{j(t),n(null)},"handleCompleteGoal");return w.length===0?e.jsx("div",{className:"max-w-4xl mx-auto px-3 sm:px-4 py-6 sm:py-8 pb-24 lg:pb-12",children:e.jsxs("div",{className:"bg-white dark:bg-dark-bg-primary rounded-xl sm:rounded-2xl border border-border-soft dark:border-dark-border/30 shadow-sm p-6 sm:p-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸŽ¯"}),e.jsx("h2",{className:"text-xl sm:text-2xl font-black text-text-primary dark:text-white mb-2",children:"No Active Goals"}),e.jsx("p",{className:"text-sm sm:text-base text-text-secondary dark:text-white/70",children:"You don't have any active goals to update. Create goals from your reflections to track progress."})]})}):e.jsx("div",{className:"max-w-4xl mx-auto px-3 sm:px-4 py-6 sm:py-8 pb-24 lg:pb-12",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary dark:text-white mb-2",children:"Update Goals"}),e.jsx("p",{className:"text-text-secondary dark:text-white/70",children:"Track your progress on active commitments"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-sm sm:text-base font-black text-text-primary dark:text-white tracking-tight",children:"Select a Goal to Update"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:w.map(t=>{const b=l.find(C=>C.id===t.valueId),r=o===t.id;return e.jsxs("button",{onClick:a(()=>n(t.id),"onClick"),className:`
                    bg-white dark:bg-dark-bg-primary p-3 sm:p-4 rounded-xl sm:rounded-2xl border transition-all text-left relative
                    ${r?"border-yellow-warm shadow-lg dark:shadow-xl":"border-border-soft dark:border-dark-border/30 shadow-sm hover:border-yellow-warm/50 dark:hover:border-yellow-warm/50"}
                  `,children:[e.jsx("span",{className:"absolute top-2 sm:top-3 right-3 sm:right-4 px-1.5 py-0.5 bg-yellow-warm/20 dark:bg-yellow-warm/30 text-yellow-warm rounded-md text-xs font-black uppercase tracking-widest",children:t.frequency}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-yellow-warm"}),e.jsx("span",{className:"text-xs sm:text-sm font-black text-text-primary/50 dark:text-white/50 uppercase tracking-widest",children:b?.name}),e.jsx(E,{status:h&&o===t.id?"processing":t.updates.length>0?"complete":"not-done",size:"sm"})]}),e.jsx("p",{className:"text-sm sm:text-base font-bold text-text-primary dark:text-white mb-2 sm:mb-3 leading-snug pr-12",children:t.text}),t.updates.length>0&&e.jsxs("p",{className:"text-xs text-text-secondary dark:text-white/60",children:[t.updates.length," update",t.updates.length!==1?"s":""]})]},t.id)})})]}),s&&e.jsxs("div",{className:"bg-white dark:bg-dark-bg-primary rounded-xl sm:rounded-2xl border border-border-soft dark:border-dark-border/30 shadow-sm p-4 sm:p-6 space-y-4 sm:space-y-6 animate-pop",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm sm:text-base font-black text-text-primary dark:text-white tracking-tight",children:"Update Progress"}),e.jsx("button",{onClick:a(()=>{n(null),m(""),p(void 0)},"onClick"),className:"w-8 h-8 flex items-center justify-center rounded-full bg-bg-secondary dark:bg-dark-bg-primary/50 text-text-tertiary hover:text-text-primary dark:hover:text-white transition-colors","aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"bg-bg-secondary dark:bg-dark-bg-primary/50 rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsx("p",{className:"text-sm sm:text-base font-bold text-text-primary dark:text-white mb-1",children:s.text}),e.jsxs("p",{className:"text-xs sm:text-sm text-text-secondary dark:text-white/60",children:[l.find(t=>t.id===s.valueId)?.name," â€¢ ",s.frequency]})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-black text-text-primary/50 dark:text-white/50 uppercase tracking-widest mb-2 px-1",children:"How's it going?"}),e.jsx("textarea",{value:c,onChange:a(t=>m(t.target.value),"onChange"),placeholder:"Share your progress, challenges, or insights...",className:"w-full p-3 sm:p-4 rounded-xl sm:rounded-2xl bg-bg-secondary dark:bg-dark-bg-primary/50 border-none focus:ring-2 focus:ring-yellow-warm/30 outline-none text-text-primary dark:text-white min-h-[100px] sm:min-h-[120px] resize-none text-sm sm:text-base leading-relaxed shadow-inner"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-black text-text-primary/50 dark:text-white/50 uppercase tracking-widest mb-2 px-1",children:"Current Energy (Optional)"}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5 sm:gap-2",children:["ðŸŒ±","ðŸ”¥","âœ¨","ðŸ§—"].map(t=>e.jsx("button",{onClick:a(()=>p(x===t?void 0:t),"onClick"),className:`
                        p-2 sm:p-3 rounded-lg sm:rounded-xl border-2 transition-all active:scale-95
                        ${x===t?"border-yellow-warm bg-yellow-warm/20 dark:bg-yellow-warm/20 shadow-sm scale-105":"border-border-soft dark:border-dark-border/30 hover:border-yellow-warm/50 bg-white dark:bg-dark-bg-primary"}
                      `,children:e.jsx("span",{className:"text-xl sm:text-2xl",children:t})},t))})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:N,disabled:!c.trim()||h,className:"flex-1 py-2 sm:py-2.5 bg-yellow-warm text-text-primary rounded-lg sm:rounded-xl font-black uppercase tracking-widest text-xs sm:text-sm shadow-sm hover:opacity-90 transition-all active:scale-[0.98] disabled:opacity-30 disabled:cursor-not-allowed",children:h?"Saving...":"ðŸ’¾ Save Update"}),g?.emergencyContact?.email&&e.jsx("button",{onClick:a(async()=>{const t=d.map(r=>r.id===s.id?{...r,updates:[...r.updates]}:r),b=U(t,l,[],!0);await D(b,[g.emergencyContact.email])},"onClick"),className:"px-3 py-2 sm:py-2.5 bg-calm-sage dark:bg-calm-sage text-white rounded-lg sm:rounded-xl font-black uppercase tracking-widest text-xs sm:text-sm shadow-sm hover:opacity-90 transition-all active:scale-[0.98]",title:"Share progress with therapist",children:"ðŸ“§ Share"}),e.jsx("button",{onClick:a(()=>S(s),"onClick"),className:"flex-1 py-2 sm:py-2.5 bg-calm-sage dark:bg-calm-sage text-white rounded-lg sm:rounded-xl font-black uppercase tracking-widest text-xs sm:text-sm shadow-sm hover:opacity-90 transition-all active:scale-[0.98]",children:"âœ… Done"}),e.jsx("button",{onClick:a(()=>v(s.id),"onClick"),className:"w-8 h-8 sm:w-10 sm:h-10 bg-bg-secondary dark:bg-dark-bg-primary/50 text-text-primary/30 dark:text-white/30 rounded-lg hover:text-red-500 dark:hover:text-red-400 flex items-center justify-center transition-colors","aria-label":"Delete goal",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})]}),f&&e.jsx("div",{className:"mt-4 p-3 bg-calm-sage/20 dark:bg-calm-sage/20 border border-calm-sage/30 rounded-lg animate-pop",children:e.jsx("p",{className:"text-xs sm:text-sm font-semibold text-calm-sage dark:text-calm-sage text-center",children:"âœ… Update saved! Email sent to therapist."})})]}),s.updates.length>0&&e.jsxs("div",{className:"mt-4 sm:mt-6 pt-4 sm:pt-6 border-t border-border-soft dark:border-dark-border/30",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-black text-text-primary dark:text-white mb-3 uppercase tracking-widest",children:"Previous Updates"}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:s.updates.slice().reverse().map(t=>e.jsxs("div",{className:"bg-bg-secondary dark:bg-dark-bg-primary/50 rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("span",{className:"text-xs text-text-secondary dark:text-white/60",children:new Date(t.timestamp).toLocaleDateString()}),t.mood&&e.jsx("span",{className:"text-lg sm:text-xl",children:t.mood})]}),e.jsx("p",{className:"text-sm sm:text-base text-text-primary dark:text-white leading-relaxed",children:t.note})]},t.id))})]})]})]})})},"GoalsUpdateView");export{T as default};
