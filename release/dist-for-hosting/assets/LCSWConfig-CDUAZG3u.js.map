{"version":3,"mappings":"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","names":["EmailScheduleComponent","userId","logs","goals","values","schedule","onUpdate","onClose","enabled","setEnabled","useState","frequency","setFrequency","time","setTime","recipientEmails","setRecipientEmails","join","sendGoalCompletions","setSendGoalCompletions","sendReports","setSendReports","jsx","className","children","jsxs","onClick","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","Fragment","map","freq","type","value","onChange","e","target","placeholder","split","filter","email","trim","test","length","checked","async","emailList","alert","emailData","generateEmailReport","slice","completedGoals","g","completed","generateGoalsEmail","subject","body","shareViaEmail","lastSent","Date","toLocaleString","newSchedule","saveEmailSchedule","AIDiagnostics","modelStatus","getModelStatus","compatibility","getCompatibilityReport","loaded","loading","canUseAI","getCompatibilitySummary","errorCategory","getErrorCategoryMessage","sharedArrayBuffer","crossOriginIsolated","webGPU","wasm","estimatedMemory","Math","round","deviceType","browser","os","issues","issue","index","recommendations","rec","moodTracker","counselingCoach","LCSWConfigComponent","config","settings","onUpdateSettings","protocols","setProtocols","crisisPhrases","setCrisisPhrases","emergencyName","setEmergencyName","emergencyContact","name","emergencyPhone","setEmergencyPhone","phone","emergencyNotes","setEmergencyNotes","notes","customPrompts","setCustomPrompts","allowRecommendations","setAllowRecommendations","allowStructuredRecommendations","showEmailSchedule","setShowEmailSchedule","crisisDetectionExpanded","setCrisisDetectionExpanded","automaticCrisisExpanded","setAutomaticCrisisExpanded","customPhrasesExpanded","setCustomPhrasesExpanded","hoveredProtocol","setHoveredProtocol","touchedProtocol","setTouchedProtocol","protocolsContainerRef","useRef","notifPermission","setNotifPermission","nextPulseInfo","setNextPulseInfo","testStatus","setTestStatus","setModelStatus","updatingModel","setUpdatingModel","selectedAIModel","setSelectedAIModel","aiModel","useEffect","setSelectedModel","hasPermission","updateModelStatus","status","error","interval","setInterval","clearInterval","handleClickOutside","event","current","contains","document","addEventListener","removeEventListener","protocolDescriptions","CBT","DBT","ACT","EMDR","Other","reminders","updatePulsePreview","currentHour","getHours","dayName","dayOfWeek","day","dayOfMonth","handleTestNtfy","ntfyTopic","newTopic","generateRandomTopic","setTimeout","testMessage","sendNotification","icon","sendNtfyNotification","topic","server","ntfyServer","ref","protocol","isTouched","showTooltip","onMouseEnter","onMouseLeave","onTouchStart","stopPropagation","hapticFeedback","prev","includes","p","toggleProtocol","window","line","idx","isUrl","href","rel","emailSchedule","open","preventDefault","permission","requestPermission","handleRequestPermission","charAt","toUpperCase","handleFrequencyChange","parseInt","min","max","useDeviceCalendar","navigator","calendar","hours","minutes","Number","eventDate","setHours","googleCalendarUrl","toISOString","replace","useNtfyPush","title","disabled","isValidTopic","newModel","initializeModels","Object","entries","getAllModelConfigs","key","description","size","confirm","import","then","n","initializeModels2","__VITE_PRELOAD__","success","message","errorMsg","String","newConfig"],"ignoreList":[],"sources":["../../components/EmailSchedule.tsx","../../components/AIDiagnostics.tsx","../../components/LCSWConfig.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { EmailSchedule } from '../types';\nimport { saveEmailSchedule, getEmailSchedule, shouldSendScheduledEmail, shareViaEmail, generateEmailReport, generateGoalsEmail } from '../services/emailService';\nimport { LogEntry, Goal, ValueItem } from '../types';\n\ninterface EmailScheduleProps {\n  userId?: string;\n  logs?: LogEntry[];\n  goals?: Goal[];\n  values?: ValueItem[];\n  schedule: EmailSchedule | undefined;\n  onUpdate: (schedule: EmailSchedule) => void;\n  onClose: () => void;\n}\n\nconst EmailScheduleComponent: React.FC<EmailScheduleProps> = ({\n  userId = '',\n  logs = [],\n  goals = [],\n  values = [],\n  schedule,\n  onUpdate,\n  onClose\n}) => {\n  const [enabled, setEnabled] = useState(schedule?.enabled || false);\n  const [frequency, setFrequency] = useState<EmailSchedule['frequency']>(schedule?.frequency || 'weekly');\n  const [time, setTime] = useState(schedule?.time || '09:00');\n  const [recipientEmails, setRecipientEmails] = useState(schedule?.recipientEmails?.join('\\n') || '');\n  const [sendGoalCompletions, setSendGoalCompletions] = useState(schedule?.sendGoalCompletions ?? true);\n  const [sendReports, setSendReports] = useState(schedule?.sendReports ?? true);\n\n  const handleSave = () => {\n    const emailList = recipientEmails.split('\\n')\n      .map(email => email.trim())\n      .filter(email => email.length > 0 && /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email));\n\n    const newSchedule: EmailSchedule = {\n      enabled,\n      frequency,\n      time,\n      recipientEmails: emailList,\n      sendGoalCompletions,\n      sendReports,\n      lastSent: schedule?.lastSent\n    };\n\n    if (userId) {\n      saveEmailSchedule(userId, newSchedule);\n    }\n    onUpdate(newSchedule);\n    onClose();\n  };\n\n  const handleTestEmail = async () => {\n    const emailList = recipientEmails.split('\\n')\n      .map(email => email.trim())\n      .filter(email => email.length > 0 && /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email));\n\n    if (emailList.length === 0) {\n      alert('Please add at least one valid email address');\n      return;\n    }\n\n    let emailData;\n    if (sendReports && logs.length > 0) {\n      emailData = generateEmailReport(logs.slice(0, 10), values);\n    } else {\n      const completedGoals = goals.filter(g => g.completed);\n      emailData = generateGoalsEmail(goals, values, completedGoals);\n    }\n\n    emailData.subject = `[TEST] ${emailData.subject}`;\n    emailData.body = `This is a test email from Grounded by AC MiNDS.\\n\\n${emailData.body}`;\n\n    const success = await shareViaEmail(emailData, emailList);\n    if (success) {\n      alert('Test email opened! Check your email client.');\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-navy-dark/60 backdrop-blur-sm\">\n      <div className=\"bg-white dark:bg-dark-bg-primary w-full max-w-2xl rounded-xl sm:rounded-2xl shadow-2xl overflow-hidden max-h-[90vh] overflow-y-auto\">\n        <div className=\"p-6 sm:p-8 space-y-6\">\n          <div className=\"flex justify-between items-center\">\n            <div>\n              <h2 className=\"text-xl sm:text-2xl font-black text-text-primary dark:text-white tracking-tight\">\n                Email Schedule\n              </h2>\n              <p className=\"text-sm text-text-secondary dark:text-text-secondary mt-1\">\n                Automatically send summaries to your therapist\n              </p>\n            </div>\n            <button \n              onClick={onClose}\n              className=\"w-10 h-10 flex items-center justify-center rounded-full bg-bg-secondary dark:bg-dark-bg-secondary text-text-tertiary dark:text-text-tertiary hover:text-text-primary dark:hover:text-white\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Enable/Disable */}\n            <div className=\"flex items-center justify-between p-4 bg-bg-secondary dark:bg-dark-bg-secondary rounded-xl border border-border-soft dark:border-dark-border\">\n              <div className=\"flex-1\">\n                <label className=\"text-sm font-black text-text-primary dark:text-white block mb-1\">\n                  Enable Email Schedule\n                </label>\n                <p className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                  Automatically send summaries at scheduled times\n                </p>\n              </div>\n              <button\n                onClick={() => setEnabled(!enabled)}\n                className={`w-16 h-8 rounded-full transition-all relative flex-shrink-0 ${enabled ? 'bg-navy-primary' : 'bg-border-soft dark:bg-dark-border'}`}\n                aria-label={enabled ? 'Disable email schedule' : 'Enable email schedule'}\n              >\n                <div className={`absolute top-1 w-6 h-6 bg-white rounded-full shadow-md transition-all ${enabled ? 'left-9' : 'left-1'}`} />\n              </button>\n            </div>\n\n            {enabled && (\n              <>\n                {/* Frequency */}\n                <div>\n                  <label className=\"block text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-3\">\n                    Frequency\n                  </label>\n                  <div className=\"flex gap-2\">\n                    {(['daily', 'weekly', 'monthly'] as EmailSchedule['frequency'][]).map(freq => (\n                      <button\n                        key={freq}\n                        onClick={() => setFrequency(freq)}\n                        className={`flex-1 py-3 rounded-xl text-sm font-black uppercase tracking-widest transition-all border ${\n                          frequency === freq\n                            ? 'bg-yellow-warm text-navy-primary shadow-sm border-yellow-warm'\n                            : 'bg-bg-secondary dark:bg-dark-bg-secondary text-text-primary dark:text-white border-border-soft dark:border-dark-border hover:bg-bg-tertiary dark:hover:bg-dark-bg-tertiary'\n                        }`}\n                      >\n                        {freq}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Time */}\n                <div>\n                  <label className=\"block text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-3\">\n                    Send Time\n                  </label>\n                  <input\n                    type=\"time\"\n                    value={time}\n                    onChange={(e) => setTime(e.target.value)}\n                    className=\"w-full px-4 py-3 rounded-xl bg-bg-secondary dark:bg-dark-bg-secondary border border-border-soft dark:border-dark-border focus:ring-2 focus:ring-navy-primary/30 dark:focus:ring-navy-primary/50 outline-none text-text-primary dark:text-white font-bold\"\n                  />\n                </div>\n\n                {/* Recipient Emails */}\n                <div>\n                  <label className=\"block text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-3\">\n                    Therapist Email(s)\n                  </label>\n                  <p className=\"text-xs text-text-secondary dark:text-text-secondary mb-2\">\n                    One email address per line. You can add multiple recipients.\n                  </p>\n                  <textarea\n                    value={recipientEmails}\n                    onChange={(e) => setRecipientEmails(e.target.value)}\n                    placeholder=\"therapist@example.com&#10;lcsw@example.com&#10;supervisor@example.com\"\n                    className=\"w-full px-4 py-3 rounded-xl bg-bg-secondary dark:bg-dark-bg-secondary border border-border-soft dark:border-dark-border focus:ring-2 focus:ring-navy-primary/30 dark:focus:ring-navy-primary/50 outline-none text-text-primary dark:text-white min-h-[100px] resize-none text-sm\"\n                  />\n                  {recipientEmails && (\n                    <div className=\"mt-2 p-2 bg-bg-tertiary dark:bg-dark-bg-tertiary rounded-lg\">\n                      <p className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                        {recipientEmails.split('\\n').filter(email => email.trim() && /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email.trim())).length} valid email(s) entered\n                      </p>\n                    </div>\n                  )}\n                </div>\n\n                {/* What to Send */}\n                <div className=\"space-y-3\">\n                  <label className=\"block text-xs font-black text-text-primary dark:text-white uppercase tracking-widest\">\n                    What to Include\n                  </label>\n                  \n                  <label className=\"flex items-start gap-3 cursor-pointer p-3 bg-bg-secondary dark:bg-dark-bg-secondary rounded-xl border border-border-soft dark:border-dark-border hover:bg-bg-tertiary dark:hover:bg-dark-bg-tertiary transition-colors\">\n                    <input\n                      type=\"checkbox\"\n                      checked={sendReports}\n                      onChange={(e) => setSendReports(e.target.checked)}\n                      className=\"mt-1 w-5 h-5 rounded border-2 border-text-primary/30 dark:border-white/30 text-yellow-warm focus:ring-2 focus:ring-yellow-warm/50 cursor-pointer\"\n                    />\n                    <div className=\"flex-1\">\n                      <span className=\"text-sm font-bold text-text-primary dark:text-white block\">\n                        Clinical Reports\n                      </span>\n                      <span className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                        Include SOAP/DAP/BIRP formatted summaries\n                      </span>\n                    </div>\n                  </label>\n\n                  <label className=\"flex items-start gap-3 cursor-pointer p-3 bg-bg-secondary dark:bg-dark-bg-secondary rounded-xl border border-border-soft dark:border-dark-border hover:bg-bg-tertiary dark:hover:bg-dark-bg-tertiary transition-colors\">\n                    <input\n                      type=\"checkbox\"\n                      checked={sendGoalCompletions}\n                      onChange={(e) => setSendGoalCompletions(e.target.checked)}\n                      className=\"mt-1 w-5 h-5 rounded border-2 border-text-primary/30 dark:border-white/30 text-yellow-warm focus:ring-2 focus:ring-yellow-warm/50 cursor-pointer\"\n                    />\n                    <div className=\"flex-1\">\n                      <span className=\"text-sm font-bold text-text-primary dark:text-white block\">\n                        Goal Completions\n                      </span>\n                      <span className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                        Send email when goals are completed\n                      </span>\n                    </div>\n                  </label>\n                </div>\n\n                {/* Test Email */}\n                <button\n                  onClick={handleTestEmail}\n                  className=\"w-full py-3 bg-yellow-warm/20 dark:bg-yellow-warm/30 text-yellow-warm dark:text-yellow-warm rounded-xl text-sm font-black uppercase tracking-widest hover:bg-yellow-warm/30 dark:hover:bg-yellow-warm/40 border border-yellow-warm/30 dark:border-yellow-warm/50\"\n                >\n                  Send Test Email\n                </button>\n              </>\n            )}\n\n            {schedule?.lastSent && (\n              <div className=\"p-3 bg-bg-secondary dark:bg-dark-bg-secondary rounded-xl border border-border-soft dark:border-dark-border\">\n                <p className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                  Last sent: {new Date(schedule.lastSent).toLocaleString()}\n                </p>\n              </div>\n            )}\n          </div>\n\n          <div className=\"flex gap-3 pt-4\">\n            <button\n              onClick={onClose}\n              className=\"flex-1 px-6 py-3 bg-bg-secondary dark:bg-dark-bg-secondary text-text-primary dark:text-white rounded-xl text-sm font-black uppercase tracking-widest hover:bg-bg-tertiary dark:hover:bg-dark-bg-tertiary border border-border-soft dark:border-dark-border\"\n            >\n              Cancel\n            </button>\n            <button\n              onClick={handleSave}\n              className=\"flex-1 px-6 py-3 bg-navy-primary text-white rounded-xl text-sm font-black uppercase tracking-widest hover:opacity-90 shadow-lg border border-navy-primary\"\n            >\n              Save Schedule\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EmailScheduleComponent;\n\n","import React from 'react';\nimport { CompatibilityReport, getCompatibilitySummary } from '../services/ai/browserCompatibility';\nimport { getModelStatus, getCompatibilityReport } from '../services/ai/models';\n\ninterface AIDiagnosticsProps {\n  className?: string;\n}\n\nconst AIDiagnostics: React.FC<AIDiagnosticsProps> = ({ className = '' }) => {\n  const modelStatus = getModelStatus();\n  const compatibility = modelStatus.compatibility || getCompatibilityReport();\n\n  if (!compatibility) {\n    return null;\n  }\n\n  const getStatusColor = () => {\n    if (modelStatus.loaded) return 'text-green-600 dark:text-green-400';\n    if (modelStatus.loading) return 'text-yellow-600 dark:text-yellow-400';\n    if (!compatibility.canUseAI) return 'text-red-600 dark:text-red-400';\n    return 'text-orange-600 dark:text-orange-400';\n  };\n\n  const getStatusIcon = () => {\n    if (modelStatus.loaded) return '✅';\n    if (modelStatus.loading) return '⏳';\n    if (!compatibility.canUseAI) return '❌';\n    return '⚠️';\n  };\n\n  const getErrorCategoryMessage = () => {\n    switch (modelStatus.errorCategory) {\n      case 'coop-coep':\n        return 'Server configuration required: Enable COOP/COEP headers (see SERVER_CONFIG.md)';\n      case 'memory':\n        return 'Insufficient device memory: Close other applications or use a device with more RAM';\n      case 'webgpu':\n        return 'GPU acceleration unavailable: Using CPU-only mode (slower but functional)';\n      case 'network':\n        return 'Network error: Check your internet connection and try again';\n      case 'wasm':\n        return 'WebAssembly not supported: Use a modern browser';\n      case 'unknown':\n        return 'Unknown error: Browser compatibility issue detected';\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      <div className=\"bg-bg-secondary dark:bg-dark-bg-secondary rounded-xl p-4 border border-border-soft dark:border-dark-border\">\n        <div className=\"flex items-start gap-3 mb-3\">\n          <span className=\"text-2xl\">{getStatusIcon()}</span>\n          <div className=\"flex-1\">\n            <h3 className=\"text-sm font-black text-text-primary dark:text-white mb-1\">\n              AI Engine Status\n            </h3>\n            <p className={`text-xs font-bold ${getStatusColor()}`}>\n              {getCompatibilitySummary(compatibility)}\n            </p>\n          </div>\n        </div>\n\n        {modelStatus.errorCategory && (\n          <div className=\"mt-3 pt-3 border-t border-border-soft dark:border-dark-border\">\n            <p className=\"text-xs text-text-secondary dark:text-text-secondary\">\n              {getErrorCategoryMessage()}\n            </p>\n          </div>\n        )}\n      </div>\n\n      <div className=\"bg-bg-secondary dark:bg-dark-bg-secondary rounded-xl p-4 border border-border-soft dark:border-dark-border space-y-3\">\n        <h4 className=\"text-xs font-black text-text-primary dark:text-white uppercase tracking-widest\">\n          Browser Capabilities\n        </h4>\n        \n        <div className=\"grid grid-cols-2 gap-2 text-xs\">\n          <div className=\"flex items-center gap-2\">\n            <span className={compatibility.sharedArrayBuffer ? 'text-green-600' : 'text-red-600'}>\n              {compatibility.sharedArrayBuffer ? '✓' : '✗'}\n            </span>\n            <span className=\"text-text-secondary dark:text-text-secondary\">SharedArrayBuffer</span>\n          </div>\n          \n          <div className=\"flex items-center gap-2\">\n            <span className={compatibility.crossOriginIsolated ? 'text-green-600' : 'text-red-600'}>\n              {compatibility.crossOriginIsolated ? '✓' : '✗'}\n            </span>\n            <span className=\"text-text-secondary dark:text-text-secondary\">Cross-Origin Isolation</span>\n          </div>\n          \n          <div className=\"flex items-center gap-2\">\n            <span className={compatibility.webGPU ? 'text-green-600' : 'text-yellow-600'}>\n              {compatibility.webGPU ? '✓' : '⚠'}\n            </span>\n            <span className=\"text-text-secondary dark:text-text-secondary\">WebGPU</span>\n          </div>\n          \n          <div className=\"flex items-center gap-2\">\n            <span className={compatibility.wasm ? 'text-green-600' : 'text-red-600'}>\n              {compatibility.wasm ? '✓' : '✗'}\n            </span>\n            <span className=\"text-text-secondary dark:text-text-secondary\">WebAssembly</span>\n          </div>\n        </div>\n\n        {compatibility.estimatedMemory && (\n          <div className=\"pt-2 border-t border-border-soft dark:border-dark-border\">\n            <div className=\"flex justify-between items-center text-xs\">\n              <span className=\"text-text-secondary dark:text-text-secondary\">Estimated Memory</span>\n              <span className=\"font-bold text-text-primary dark:text-white\">\n                {Math.round(compatibility.estimatedMemory)} MB\n              </span>\n            </div>\n          </div>\n        )}\n\n        <div className=\"pt-2 border-t border-border-soft dark:border-dark-border\">\n          <div className=\"flex justify-between items-center text-xs\">\n            <span className=\"text-text-secondary dark:text-text-secondary\">Device</span>\n            <span className=\"font-bold text-text-primary dark:text-white capitalize\">\n              {compatibility.deviceType}\n            </span>\n          </div>\n          <div className=\"flex justify-between items-center text-xs mt-1\">\n            <span className=\"text-text-secondary dark:text-text-secondary\">Browser</span>\n            <span className=\"font-bold text-text-primary dark:text-white\">\n              {compatibility.browser} on {compatibility.os}\n            </span>\n          </div>\n        </div>\n      </div>\n\n      {compatibility.issues.length > 0 && (\n        <div className=\"bg-yellow-warm/10 dark:bg-yellow-warm/20 rounded-xl p-4 border border-yellow-warm/30 dark:border-yellow-warm/50\">\n          <h4 className=\"text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-2\">\n            Issues Detected\n          </h4>\n          <ul className=\"space-y-1\">\n            {compatibility.issues.map((issue, index) => (\n              <li key={index} className=\"text-xs text-text-secondary dark:text-text-secondary flex items-start gap-2\">\n                <span className=\"text-yellow-warm mt-0.5\">•</span>\n                <span>{issue}</span>\n              </li>\n            ))}\n          </ul>\n        </div>\n      )}\n\n      {compatibility.recommendations.length > 0 && (\n        <div className=\"bg-navy-primary/10 dark:bg-navy-primary/20 rounded-xl p-4 border border-navy-primary/30 dark:border-navy-primary/50\">\n          <h4 className=\"text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-2\">\n            Recommendations\n          </h4>\n          <ul className=\"space-y-1\">\n            {compatibility.recommendations.map((rec, index) => (\n              <li key={index} className=\"text-xs text-text-secondary dark:text-text-secondary flex items-start gap-2\">\n                <span className=\"text-navy-primary dark:text-yellow-warm mt-0.5\">→</span>\n                <span>{rec}</span>\n              </li>\n            ))}\n          </ul>\n        </div>\n      )}\n\n      {modelStatus.loaded && (\n        <div className=\"bg-green-50 dark:bg-green-900/20 rounded-xl p-4 border border-green-200 dark:border-green-800\">\n          <div className=\"flex items-center gap-2 text-xs\">\n            <span className=\"text-green-600 dark:text-green-400\">✓</span>\n            <span className=\"font-bold text-green-700 dark:text-green-300\">\n              AI models loaded successfully\n            </span>\n          </div>\n          <div className=\"mt-2 grid grid-cols-2 gap-2 text-xs\">\n            <div className=\"flex items-center gap-2\">\n              <span className={modelStatus.moodTracker ? 'text-green-600' : 'text-red-600'}>\n                {modelStatus.moodTracker ? '✓' : '✗'}\n              </span>\n              <span className=\"text-text-secondary dark:text-text-secondary\">Mood Tracker</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <span className={modelStatus.counselingCoach ? 'text-green-600' : 'text-red-600'}>\n                {modelStatus.counselingCoach ? '✓' : '✗'}\n              </span>\n              <span className=\"text-text-secondary dark:text-text-secondary\">Counseling Coach</span>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AIDiagnostics;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { LCSWConfig, AppSettings, ReminderFrequency } from '../types';\nimport EmailScheduleComponent from './EmailSchedule';\nimport AIDiagnostics from './AIDiagnostics';\nimport { hapticFeedback } from '../utils/animations';\nimport { sendNtfyNotification, generateRandomTopic, isValidTopic } from '../services/ntfyService';\nimport { ALL_VALUES } from '../constants';\nimport { requestPermission, hasPermission, sendNotification } from '../services/notifications';\nimport { getModelStatus, areModelsLoaded, getSelectedModel, setSelectedModel, getAllModelConfigs, initializeModels } from '../services/aiService';\nimport { AIModelType } from '../types';\n\ninterface LCSWConfigProps {\n  config: LCSWConfig | undefined;\n  onUpdate: (config: LCSWConfig) => void;\n  onClose: () => void;\n  settings?: AppSettings;\n  onUpdateSettings?: (settings: AppSettings) => void;\n}\n\nconst LCSWConfigComponent: React.FC<LCSWConfigProps> = ({ config, onUpdate, onClose, settings, onUpdateSettings }) => {\n  const [protocols, setProtocols] = useState<string[]>(config?.protocols || []);\n  const [crisisPhrases, setCrisisPhrases] = useState<string>(config?.crisisPhrases?.join('\\n') || '');\n  const [emergencyName, setEmergencyName] = useState(config?.emergencyContact?.name || '');\n  const [emergencyPhone, setEmergencyPhone] = useState(config?.emergencyContact?.phone || '');\n  const [emergencyNotes, setEmergencyNotes] = useState(config?.emergencyContact?.notes || '');\n  const [customPrompts, setCustomPrompts] = useState<string>(config?.customPrompts?.join('\\n') || '');\n  const [allowRecommendations, setAllowRecommendations] = useState(config?.allowStructuredRecommendations ?? true);\n  const [showEmailSchedule, setShowEmailSchedule] = useState(false);\n  \n  // Collapsible state\n  const [crisisDetectionExpanded, setCrisisDetectionExpanded] = useState(false);\n  const [automaticCrisisExpanded, setAutomaticCrisisExpanded] = useState(false);\n  const [customPhrasesExpanded, setCustomPhrasesExpanded] = useState(false);\n  \n  // Tooltip state\n  const [hoveredProtocol, setHoveredProtocol] = useState<string | null>(null);\n  const [touchedProtocol, setTouchedProtocol] = useState<string | null>(null);\n  const protocolsContainerRef = useRef<HTMLDivElement>(null);\n  \n  // Accountability Engine state\n  const [notifPermission, setNotifPermission] = useState<NotificationPermission>('default');\n  const [nextPulseInfo, setNextPulseInfo] = useState<string>('');\n  const [testStatus, setTestStatus] = useState<'idle' | 'sending' | 'success' | 'error'>('idle');\n  \n  // AI Model status\n  const [modelStatus, setModelStatus] = useState<{ loaded: boolean; loading: boolean; moodTracker: boolean; counselingCoach: boolean } | null>(null);\n  const [updatingModel, setUpdatingModel] = useState(false);\n  const [selectedAIModel, setSelectedAIModel] = useState<AIModelType>(settings?.aiModel || 'tinyllama');\n  \n  // Sync selected model with settings when they change\n  useEffect(() => {\n    if (settings?.aiModel) {\n      setSelectedAIModel(settings.aiModel);\n      setSelectedModel(settings.aiModel);\n    }\n  }, [settings?.aiModel]);\n\n  // Update permission state on mount\n  useEffect(() => {\n    if (hasPermission()) {\n      setNotifPermission('granted');\n    } else {\n      setNotifPermission('default');\n    }\n  }, []);\n  \n  // Update model status\n  useEffect(() => {\n    const updateModelStatus = () => {\n      try {\n        const status = getModelStatus();\n        setModelStatus(status);\n      } catch (error) {\n        console.warn('Could not get model status:', error);\n      }\n    };\n    \n    updateModelStatus();\n    // Update status every 2 seconds to show real-time loading state\n    const interval = setInterval(updateModelStatus, 2000);\n    \n    return () => clearInterval(interval);\n  }, []);\n  \n  // Dismiss tooltip when clicking outside on mobile\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent | TouchEvent) => {\n      if (\n        touchedProtocol &&\n        protocolsContainerRef.current &&\n        !protocolsContainerRef.current.contains(event.target as Node)\n      ) {\n        setTouchedProtocol(null);\n      }\n    };\n    \n    if (touchedProtocol) {\n      // Add listeners for both mouse and touch events\n      document.addEventListener('mousedown', handleClickOutside);\n      document.addEventListener('touchstart', handleClickOutside);\n    }\n    \n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n      document.removeEventListener('touchstart', handleClickOutside);\n    };\n  }, [touchedProtocol]);\n\n  const protocolOptions: ('CBT' | 'DBT' | 'ACT' | 'EMDR' | 'Other')[] = ['CBT', 'DBT', 'ACT', 'EMDR', 'Other'];\n  \n  // Protocol descriptions\n  const protocolDescriptions: Record<string, string> = {\n    'CBT': 'Cognitive Behavioral Therapy: Focuses on identifying and changing negative thought patterns and behaviors.',\n    'DBT': 'Dialectical Behavior Therapy: Combines cognitive-behavioral techniques with mindfulness and acceptance strategies.',\n    'ACT': 'Acceptance and Commitment Therapy: Emphasizes accepting difficult thoughts and feelings while committing to values-based actions.',\n    'EMDR': 'Eye Movement Desensitization and Reprocessing: Uses bilateral stimulation to process traumatic memories and reduce distress.',\n    'Other': 'Other therapeutic approaches or custom protocols specific to your treatment plan.'\n  };\n\n  const handleSave = () => {\n    const newConfig: LCSWConfig = {\n      protocols: protocols as ('CBT' | 'DBT' | 'ACT' | 'EMDR' | 'Other')[],\n      crisisPhrases: crisisPhrases.split('\\n').filter(p => p.trim().length > 0),\n      emergencyContact: emergencyName || emergencyPhone ? {\n        name: emergencyName,\n        phone: emergencyPhone,\n        notes: emergencyNotes || undefined\n      } : undefined,\n      customPrompts: customPrompts.split('\\n').filter(p => p.trim().length > 0),\n      allowStructuredRecommendations: allowRecommendations\n    };\n    onUpdate(newConfig);\n    onClose();\n  };\n\n  const toggleProtocol = (protocol: string) => {\n    setProtocols(prev => \n      prev.includes(protocol) \n        ? prev.filter(p => p !== protocol)\n        : [...prev, protocol]\n    );\n  };\n\n  // Accountability Engine handlers\n  useEffect(() => {\n    if (!settings?.reminders) return;\n    \n    const updatePulsePreview = () => {\n      if (!settings.reminders.enabled) {\n        setNextPulseInfo('Disabled');\n        return;\n      }\n\n      const now = new Date();\n      const currentHour = now.getHours();\n      const frequency = settings.reminders.frequency || 'daily';\n      \n      switch (frequency) {\n        case 'hourly':\n          if (currentHour >= 8 && currentHour < 20) {\n            setNextPulseInfo(`Hourly: ${currentHour + 1}:00`);\n          } else {\n            setNextPulseInfo('Hourly: 8:00 AM');\n          }\n          break;\n        case 'daily':\n          setNextPulseInfo(`Daily: ${settings.reminders.time}`);\n          break;\n        case 'weekly':\n          const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n          const targetDay = settings.reminders.dayOfWeek ?? 0;\n          const dayName = days[targetDay];\n          setNextPulseInfo(`Weekly: ${dayName} at ${settings.reminders.time}`);\n          break;\n        case 'monthly':\n          const day = settings.reminders.dayOfMonth ?? 1;\n          setNextPulseInfo(`Monthly: Day ${day} at ${settings.reminders.time}`);\n          break;\n        default:\n          setNextPulseInfo(`Daily: ${settings.reminders.time}`);\n          break;\n      }\n    };\n\n    updatePulsePreview();\n    const interval = setInterval(updatePulsePreview, 60000);\n    return () => clearInterval(interval);\n  }, [settings?.reminders]);\n\n  const handleRequestPermission = async () => {\n    const permission = await requestPermission();\n    setNotifPermission(permission);\n  };\n\n  const toggleReminders = () => {\n    if (!settings || !onUpdateSettings) return;\n    if (notifPermission !== 'granted') {\n      handleRequestPermission();\n    }\n    onUpdateSettings({\n      ...settings,\n      reminders: { ...settings.reminders, enabled: !settings.reminders.enabled }\n    });\n  };\n\n  const handleFrequencyChange = (frequency: ReminderFrequency) => {\n    if (!settings || !onUpdateSettings) return;\n    onUpdateSettings({\n      ...settings,\n      reminders: { ...settings.reminders, frequency }\n    });\n  };\n\n  const handleTimeChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!settings || !onUpdateSettings) return;\n    onUpdateSettings({\n      ...settings,\n      reminders: { ...settings.reminders, time: e.target.value }\n    });\n  };\n\n  const handleDayOfWeekChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    if (!settings || !onUpdateSettings) return;\n    onUpdateSettings({\n      ...settings,\n      reminders: { ...settings.reminders, dayOfWeek: parseInt(e.target.value) }\n    });\n  };\n\n  const handleDayOfMonthChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!settings || !onUpdateSettings) return;\n    const day = parseInt(e.target.value);\n    if (day >= 1 && day <= 31) {\n      onUpdateSettings({\n        ...settings,\n        reminders: { ...settings.reminders, dayOfMonth: day }\n      });\n    }\n  };\n\n  const handleCalendarToggle = async () => {\n    if (!settings || !onUpdateSettings) return;\n    if (!settings.reminders.useDeviceCalendar) {\n      try {\n        if ('calendar' in navigator && 'requestPermission' in navigator.calendar) {\n          const permission = await (navigator.calendar as any).requestPermission();\n          if (permission === 'granted') {\n            onUpdateSettings({\n              ...settings,\n              reminders: { ...settings.reminders, useDeviceCalendar: true }\n            });\n          }\n        } else {\n          const now = new Date();\n          const [hours, minutes] = settings.reminders.time.split(':').map(Number);\n          const eventDate = new Date();\n          eventDate.setHours(hours, minutes, 0, 0);\n          const googleCalendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=Grounded Reflection Reminder&dates=${eventDate.toISOString().replace(/[-:]/g, '').split('.')[0]}Z/${eventDate.toISOString().replace(/[-:]/g, '').split('.')[0]}Z&details=Time to reflect on your values`;\n          window.open(googleCalendarUrl, '_blank');\n          onUpdateSettings({\n            ...settings,\n            reminders: { ...settings.reminders, useDeviceCalendar: true }\n          });\n        }\n      } catch (error) {\n        console.error('Calendar access error:', error);\n        alert('Could not access calendar. You can manually add reminders to your calendar.');\n      }\n    } else {\n      onUpdateSettings({\n        ...settings,\n        reminders: { ...settings.reminders, useDeviceCalendar: false }\n      });\n    }\n  };\n\n  const handleNtfyToggle = () => {\n    if (!settings || !onUpdateSettings) return;\n    if (!settings.reminders.useNtfyPush) {\n      const topic = settings.reminders.ntfyTopic || generateRandomTopic();\n      onUpdateSettings({\n        ...settings,\n        reminders: { \n          ...settings.reminders, \n          useNtfyPush: true,\n          ntfyTopic: topic\n        }\n      });\n    } else {\n      onUpdateSettings({\n        ...settings,\n        reminders: { ...settings.reminders, useNtfyPush: false }\n      });\n    }\n  };\n\n  const handleResetTopic = () => {\n    if (!settings || !onUpdateSettings) return;\n    const newTopic = generateRandomTopic();\n    onUpdateSettings({\n      ...settings,\n      reminders: { ...settings.reminders, ntfyTopic: newTopic }\n    });\n    setTestStatus('idle');\n  };\n\n  const handleNtfyTopicChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!settings || !onUpdateSettings) return;\n    const topic = e.target.value.trim();\n    if (isValidTopic(topic) || topic === '') {\n      onUpdateSettings({\n        ...settings,\n        reminders: { ...settings.reminders, ntfyTopic: topic }\n      });\n    }\n  };\n\n  const handleTestNtfy = async () => {\n    if (!settings || !onUpdateSettings) return;\n    if (!settings.reminders.ntfyTopic) {\n      const newTopic = generateRandomTopic();\n      onUpdateSettings({\n        ...settings,\n        reminders: { ...settings.reminders, ntfyTopic: newTopic }\n      });\n      setTimeout(() => handleTestNtfy(), 100);\n      return;\n    }\n    \n    setTestStatus('sending');\n    \n    try {\n      const testMessage = `💛 Test notification from Grounded! If you received this, push notifications are working perfectly!`;\n      \n      if (hasPermission()) {\n        await sendNotification('Grounded Test', {\n          body: testMessage,\n          icon: '/favicon.ico'\n        });\n      }\n      \n      const success = await sendNtfyNotification(\n        testMessage,\n        'Grounded Test',\n        {\n          topic: settings.reminders.ntfyTopic,\n          server: settings.reminders.ntfyServer\n        }\n      );\n      \n      if (success) {\n        setTestStatus('success');\n        setTimeout(() => setTestStatus('idle'), 3000);\n      } else {\n        setTestStatus('error');\n        setTimeout(() => setTestStatus('idle'), 3000);\n      }\n    } catch (error) {\n      console.error('Test notification error:', error);\n      setTestStatus('error');\n      setTimeout(() => setTestStatus('idle'), 3000);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-navy-dark/60 backdrop-blur-sm\">\n      <div className=\"bg-white dark:bg-dark-bg-primary w-full max-w-2xl rounded-[40px] shadow-2xl overflow-hidden max-h-[90vh] overflow-y-auto\">\n        <div className=\"p-8 space-y-8\">\n          <div className=\"flex justify-between items-center\">\n            <div>\n              <h2 className=\"text-2xl font-black text-text-primary dark:text-white\">Configuration</h2>\n              <p className=\"text-sm text-text-secondary dark:text-text-secondary mt-1\">Configure therapy integration settings</p>\n            </div>\n            <button \n              onClick={onClose}\n              className=\"w-10 h-10 flex items-center justify-center rounded-full bg-bg-secondary dark:bg-dark-bg-secondary text-text-tertiary dark:text-text-tertiary hover:text-text-primary dark:hover:text-white\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Treatment Protocols */}\n            <div>\n              <label className=\"text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-3 block\">\n                Treatment Protocols\n              </label>\n              <div \n                ref={protocolsContainerRef}\n                className=\"flex flex-wrap gap-2 relative\"\n              >\n                {protocolOptions.map(protocol => {\n                  const isHovered = hoveredProtocol === protocol;\n                  const isTouched = touchedProtocol === protocol;\n                  const showTooltip = isHovered || isTouched;\n                  \n                  return (\n                    <div\n                      key={protocol}\n                      className=\"relative\"\n                      onMouseEnter={() => setHoveredProtocol(protocol)}\n                      onMouseLeave={() => {\n                        setHoveredProtocol(null);\n                        // Don't clear touched on mouse leave - let user dismiss manually on mobile\n                      }}\n                      onTouchStart={(e) => {\n                        e.stopPropagation();\n                        hapticFeedback('light');\n                        // Toggle tooltip: if already showing, hide it; otherwise show it\n                        if (touchedProtocol === protocol) {\n                          setTouchedProtocol(null);\n                        } else {\n                          setTouchedProtocol(protocol);\n                        }\n                      }}\n                    >\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          toggleProtocol(protocol);\n                          // On mobile, toggle tooltip visibility on click\n                          if ('ontouchstart' in window) {\n                            if (touchedProtocol === protocol) {\n                              setTouchedProtocol(null);\n                            } else {\n                              setTouchedProtocol(protocol);\n                            }\n                          }\n                        }}\n                        className={`px-4 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all relative z-10 ${\n                          protocols.includes(protocol)\n                            ? 'bg-navy-primary text-white shadow-sm'\n                            : 'bg-bg-secondary dark:bg-dark-bg-secondary text-text-primary dark:text-white hover:bg-bg-tertiary dark:hover:bg-dark-bg-tertiary border border-border-soft dark:border-dark-border'\n                        }`}\n                      >\n                        {protocol}\n                      </button>\n                      \n                      {/* Tooltip - Persistent on mobile */}\n                      {showTooltip && (\n                        <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 z-50 w-64 sm:w-72\">\n                          <div className=\"bg-navy-dark dark:bg-dark-bg-tertiary text-white dark:text-white rounded-xl p-3 shadow-2xl border border-navy-light/30 dark:border-dark-border animate-fade-in\">\n                            <p className=\"text-[10px] sm:text-xs leading-relaxed font-medium\">\n                              {protocolDescriptions[protocol]}\n                            </p>\n                            {/* Tooltip arrow */}\n                            <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1\">\n                              <div className=\"w-2 h-2 bg-navy-dark dark:bg-dark-bg-tertiary rotate-45 border-r border-b border-navy-light/30 dark:border-dark-border\"></div>\n                            </div>\n                            {/* Close button for mobile (when tooltip is shown via touch) */}\n                            {isTouched && (\n                              <button\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  setTouchedProtocol(null);\n                                }}\n                                className=\"absolute top-1 right-1 w-6 h-6 flex items-center justify-center rounded-full bg-white/20 dark:bg-white/20 active:bg-white/30 dark:active:bg-white/30 text-white dark:text-white transition-colors touch-target\"\n                                aria-label=\"Close tooltip\"\n                              >\n                                <svg className=\"w-3.5 h-3.5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M6 18L18 6M6 6l12 12\" />\n                                </svg>\n                              </button>\n                            )}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* Crisis Phrases - Collapsible */}\n            <div>\n              <button\n                onClick={() => setCrisisDetectionExpanded(!crisisDetectionExpanded)}\n                className=\"w-full flex items-center justify-between text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-3 p-2 hover:bg-bg-secondary dark:hover:bg-dark-bg-secondary rounded-lg transition-colors\"\n              >\n                <span>Crisis Detection</span>\n                <svg \n                  className={`w-4 h-4 transition-transform ${crisisDetectionExpanded ? 'rotate-180' : ''}`} \n                  fill=\"none\" \n                  viewBox=\"0 0 24 24\" \n                  stroke=\"currentColor\"\n                >\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                </svg>\n              </button>\n              \n              {crisisDetectionExpanded && (\n                <div className=\"space-y-4\">\n                  {/* Automatic Crisis Detection - Collapsible */}\n                  <div>\n                    <button\n                      onClick={() => setAutomaticCrisisExpanded(!automaticCrisisExpanded)}\n                      className=\"w-full flex items-center justify-between p-4 bg-navy-light/10 dark:bg-navy-light/20 rounded-2xl border border-navy-light/30 dark:border-navy-light/50 hover:bg-navy-light/15 dark:hover:bg-navy-light/25 transition-colors\"\n                    >\n                      <p className=\"text-xs font-bold text-navy-primary dark:text-navy-light\">\n                        🔒 Automatic Crisis Detection (Non-Editable)\n                      </p>\n                      <svg \n                        className={`w-4 h-4 text-navy-primary dark:text-navy-light transition-transform ${automaticCrisisExpanded ? 'rotate-180' : ''}`} \n                        fill=\"none\" \n                        viewBox=\"0 0 24 24\" \n                        stroke=\"currentColor\"\n                      >\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                      </svg>\n                    </button>\n                    {automaticCrisisExpanded && (\n                      <div className=\"p-4 bg-navy-light/5 dark:bg-navy-light/10 rounded-xl mt-2 border border-navy-light/20 dark:border-navy-light/30\">\n                        <p className=\"text-xs text-navy-dark dark:text-navy-light leading-relaxed mb-2\">\n                          The app uses <strong>comprehensive, hardcoded crisis detection</strong> that monitors for over 100+ phrases across 8 categories including direct suicide statements, self-harm language, planning indicators, and immediate danger signals. These detection phrases <strong>cannot be modified or disabled</strong> to ensure consistent safety monitoring.\n                        </p>\n                        <p className=\"text-xs text-navy-primary dark:text-navy-light italic\">\n                          When crisis language is detected, the app immediately stops normal responses and displays emergency resources, crisis hotlines (988), and encourages contacting professional help or emergency services.\n                        </p>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Additional Custom Phrases - Collapsible */}\n                  <div>\n                    <button\n                      onClick={() => setCustomPhrasesExpanded(!customPhrasesExpanded)}\n                      className=\"w-full flex items-center justify-between p-4 bg-bg-secondary dark:bg-dark-bg-secondary rounded-2xl border border-border-soft dark:border-dark-border hover:bg-bg-tertiary dark:hover:bg-dark-bg-tertiary transition-colors\"\n                    >\n                      <p className=\"text-xs font-bold text-text-primary dark:text-white\">\n                        Additional Custom Phrases (Optional)\n                      </p>\n                      <svg \n                        className={`w-4 h-4 text-text-primary dark:text-white transition-transform ${customPhrasesExpanded ? 'rotate-180' : ''}`} \n                        fill=\"none\" \n                        viewBox=\"0 0 24 24\" \n                        stroke=\"currentColor\"\n                      >\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                      </svg>\n                    </button>\n                    {customPhrasesExpanded && (\n                      <div className=\"p-4 bg-bg-secondary dark:bg-dark-bg-secondary rounded-xl mt-2 border border-border-soft dark:border-dark-border\">\n                        <p className=\"text-xs text-text-secondary dark:text-text-secondary mb-2\">\n                          You can add custom phrases here, but note that the comprehensive hardcoded detection will still be active. Custom phrases are in addition to, not replacements for, the built-in safety monitoring.\n                        </p>\n                        <textarea\n                          value={crisisPhrases}\n                          onChange={(e) => setCrisisPhrases(e.target.value)}\n                          placeholder=\"Add any additional phrases specific to your practice (optional)&#10;Note: Built-in crisis detection remains active\"\n                          className=\"w-full p-4 rounded-xl bg-white dark:bg-dark-bg-tertiary border border-border-soft dark:border-dark-border focus:ring-2 focus:ring-navy-primary/30 dark:focus:ring-navy-primary/50 outline-none text-text-primary dark:text-white min-h-[100px] resize-none text-sm\"\n                        />\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Emergency Contact - Collapsible */}\n            <details className=\"group\">\n              <summary className=\"cursor-pointer text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-3 p-2 hover:bg-bg-secondary dark:hover:bg-dark-bg-secondary rounded-lg transition-colors list-none flex items-center justify-between\">\n                <span>Emergency Contact</span>\n                <svg \n                  className=\"w-4 h-4 transition-transform group-open:rotate-180\" \n                  fill=\"none\" \n                  viewBox=\"0 0 24 24\" \n                  stroke=\"currentColor\"\n                >\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                </svg>\n              </summary>\n              <div className=\"space-y-3 mt-3\">\n                <input\n                  type=\"text\"\n                  value={emergencyName}\n                  onChange={(e) => setEmergencyName(e.target.value)}\n                  placeholder=\"Therapist Name\"\n                  className=\"w-full p-4 rounded-2xl bg-bg-secondary dark:bg-dark-bg-secondary border-none focus:ring-2 focus:ring-navy-primary/30 dark:focus:ring-navy-primary/50 outline-none text-text-primary dark:text-white\"\n                />\n                <input\n                  type=\"tel\"\n                  value={emergencyPhone}\n                  onChange={(e) => setEmergencyPhone(e.target.value)}\n                  placeholder=\"Phone Number\"\n                  className=\"w-full p-4 rounded-2xl bg-bg-secondary dark:bg-dark-bg-secondary border-none focus:ring-2 focus:ring-navy-primary/30 dark:focus:ring-navy-primary/50 outline-none text-text-primary dark:text-white\"\n                />\n                <textarea\n                  value={emergencyNotes}\n                  onChange={(e) => setEmergencyNotes(e.target.value)}\n                  placeholder=\"Additional notes (e.g., 'Available 24/7', 'Text preferred')\"\n                  className=\"w-full p-4 rounded-2xl bg-bg-secondary dark:bg-dark-bg-secondary border-none focus:ring-2 focus:ring-navy-primary/30 dark:focus:ring-navy-primary/50 outline-none text-text-primary dark:text-white min-h-[80px] resize-none text-sm\"\n                />\n              </div>\n            </details>\n\n            {/* Custom Homework/Worksheets - Collapsible */}\n            <details className=\"group\">\n              <summary className=\"cursor-pointer text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-3 p-2 hover:bg-bg-secondary dark:hover:bg-dark-bg-secondary rounded-lg transition-colors list-none flex items-center justify-between\">\n                <span>Custom Homework/Worksheets</span>\n                <svg \n                  className=\"w-4 h-4 transition-transform group-open:rotate-180\" \n                  fill=\"none\" \n                  viewBox=\"0 0 24 24\" \n                  stroke=\"currentColor\"\n                >\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                </svg>\n              </summary>\n              <div className=\"mt-3 space-y-3\">\n                <p className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                  Custom prompts, worksheets, or links your therapist wants you to focus on. One per line. Links will be clickable.\n                </p>\n                <textarea\n                  value={customPrompts}\n                  onChange={(e) => setCustomPrompts(e.target.value)}\n                  placeholder=\"Practice mindfulness for 5 minutes daily&#10;Complete thought record worksheet&#10;https://example.com/worksheet.pdf&#10;Journal about triggers\"\n                  className=\"w-full p-4 rounded-2xl bg-bg-secondary dark:bg-dark-bg-secondary border border-border-soft dark:border-dark-border focus:ring-2 focus:ring-navy-primary/30 dark:focus:ring-navy-primary/50 outline-none text-text-primary dark:text-white min-h-[100px] resize-none text-sm\"\n                />\n                {customPrompts && (\n                  <div className=\"p-3 bg-bg-tertiary dark:bg-dark-bg-tertiary rounded-xl\">\n                    <p className=\"text-xs font-bold text-text-primary dark:text-white mb-2\">Preview:</p>\n                    <div className=\"space-y-1 text-xs text-text-primary dark:text-white\">\n                      {customPrompts.split('\\n').filter(line => line.trim()).map((line, idx) => {\n                        const isUrl = /^https?:\\/\\//.test(line.trim());\n                        return (\n                          <div key={idx} className=\"flex items-start gap-2\">\n                            <span className=\"text-text-tertiary\">•</span>\n                            {isUrl ? (\n                              <a \n                                href={line.trim()} \n                                target=\"_blank\" \n                                rel=\"noopener noreferrer\"\n                                className=\"text-navy-primary dark:text-navy-light hover:underline break-all\"\n                              >\n                                {line.trim()}\n                              </a>\n                            ) : (\n                              <span>{line.trim()}</span>\n                            )}\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                )}\n              </div>\n            </details>\n\n            {/* Allow Recommendations */}\n            <div className=\"flex items-center justify-between p-4 bg-bg-secondary dark:bg-dark-bg-secondary rounded-2xl border border-border-soft dark:border-dark-border\">\n              <div className=\"flex-1\">\n                <label className=\"text-xs font-black text-text-primary dark:text-white block mb-1\">\n                  Allow Structured Recommendations\n                </label>\n                <p className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                  AI can suggest structured actions aligned with your treatment plan\n                </p>\n              </div>\n              <button\n                onClick={() => setAllowRecommendations(!allowRecommendations)}\n                className={`w-14 h-8 rounded-full transition-all relative flex-shrink-0 ${\n                  allowRecommendations ? 'bg-navy-primary' : 'bg-border-soft dark:bg-dark-bg-primary'\n                }`}\n                aria-label={allowRecommendations ? 'Disable recommendations' : 'Enable recommendations'}\n              >\n                <div className={`absolute top-1 w-6 h-6 bg-white rounded-full shadow-md transition-all ${\n                  allowRecommendations ? 'right-1' : 'left-1'\n                }`} />\n              </button>\n            </div>\n\n            {/* Email Summaries - Collapsible */}\n            {settings && onUpdateSettings && (\n              <details className=\"group border-t border-border-soft dark:border-dark-border pt-6\">\n                <summary className=\"cursor-pointer list-none\">\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <div>\n                      <label className=\"text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-1 block\">\n                        Email Summaries\n                      </label>\n                      <p className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                        Schedule automatic reports to your therapist\n                      </p>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      {settings.emailSchedule?.enabled && (\n                        <span className=\"px-2 py-1 bg-calm-sage/20 dark:bg-calm-sage/20 text-calm-sage dark:text-calm-sage rounded-lg text-[9px] font-black uppercase tracking-widest\">\n                          Active\n                        </span>\n                      )}\n                      <svg \n                        className=\"w-4 h-4 text-text-primary dark:text-white transition-transform group-open:rotate-180\" \n                        fill=\"none\" \n                        viewBox=\"0 0 24 24\" \n                        stroke=\"currentColor\"\n                      >\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                      </svg>\n                    </div>\n                  </div>\n                </summary>\n                <div className=\"space-y-4\">\n                  <button\n                    onClick={() => setShowEmailSchedule(true)}\n                    className=\"w-full px-4 py-3 bg-navy-primary text-white dark:text-white rounded-xl text-xs font-black uppercase tracking-widest hover:opacity-90 border border-navy-primary\"\n                  >\n                    Configure Email Summaries\n                  </button>\n                  {settings.emailSchedule?.enabled && (\n                    <div className=\"p-4 bg-bg-secondary dark:bg-dark-bg-secondary rounded-xl border border-border-soft dark:border-dark-border\">\n                      <p className=\"text-xs text-text-primary dark:text-white mb-1\">\n                        <strong>Active:</strong> {settings.emailSchedule.frequency} at {settings.emailSchedule.time}\n                      </p>\n                      <p className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                        Recipients: {settings.emailSchedule.recipientEmails.length} email(s)\n                      </p>\n                    </div>\n                  )}\n                </div>\n              </details>\n            )}\n\n            {/* Growth and Progress (Accountability Engine) - Collapsible */}\n            {settings && onUpdateSettings && (\n              <details className=\"group border-t border-border-soft dark:border-dark-border pt-6\" open={false}>\n                <summary className=\"cursor-pointer list-none\">\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <div>\n                      <label className=\"text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-1 block\">\n                        Growth and Progress\n                      </label>\n                      <p className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                        Keep your North Star in sight throughout the day\n                      </p>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <button \n                        onClick={(e) => {\n                          e.preventDefault();\n                          toggleReminders();\n                        }}\n                        className={`w-14 h-8 rounded-full transition-all relative ${settings.reminders.enabled ? 'bg-yellow-warm' : 'bg-border-soft dark:bg-dark-bg-primary'}`}\n                      >\n                        <div className={`absolute top-1 w-6 h-6 bg-white rounded-full shadow-md transition-all ${settings.reminders.enabled ? 'right-1' : 'left-1'}`} />\n                      </button>\n                      <svg \n                        className=\"w-4 h-4 text-text-primary dark:text-white transition-transform group-open:rotate-180\" \n                        fill=\"none\" \n                        viewBox=\"0 0 24 24\" \n                        stroke=\"currentColor\"\n                      >\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                      </svg>\n                    </div>\n                  </div>\n                </summary>\n                <div className={`space-y-6 transition-all duration-500 ${settings.reminders.enabled ? 'opacity-100 scale-100' : 'opacity-30 scale-95 pointer-events-none'}`}>\n                  {/* Frequency Selector */}\n                  <div className=\"space-y-3\">\n                    <label className=\"text-[10px] font-black text-text-primary/60 dark:text-white/60 uppercase tracking-widest block\">\n                      {(settings.reminders.frequency || 'daily').charAt(0).toUpperCase() + (settings.reminders.frequency || 'daily').slice(1)} Reflection Reminder\n                    </label>\n                    <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-2\">\n                      {(['hourly', 'daily', 'weekly', 'monthly'] as ReminderFrequency[]).map((freq) => (\n                        <button\n                          key={freq}\n                          onClick={() => handleFrequencyChange(freq)}\n                          className={`px-4 py-3 rounded-xl font-black text-xs uppercase tracking-widest transition-all ${\n                            (settings.reminders.frequency || 'daily') === freq\n                              ? 'bg-yellow-warm text-text-primary shadow-lg scale-105'\n                              : 'bg-bg-secondary dark:bg-dark-bg-primary/50 text-text-primary/60 dark:text-white/60 hover:bg-yellow-warm/20 dark:hover:bg-yellow-warm/20'\n                          }`}\n                        >\n                          {freq}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n\n                  {/* Time and Schedule Options */}\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                    {((settings.reminders.frequency || 'daily') === 'daily' || (settings.reminders.frequency || 'daily') === 'weekly' || (settings.reminders.frequency || 'daily') === 'monthly') && (\n                      <div className=\"space-y-2\">\n                        <label className=\"text-[10px] font-black text-text-primary/60 dark:text-white/60 uppercase tracking-widest block\">\n                          Time\n                        </label>\n                        <input \n                          type=\"time\" \n                          value={settings.reminders.time}\n                          onChange={handleTimeChange}\n                          className=\"w-full bg-bg-secondary dark:bg-dark-bg-primary/50 border border-border-soft dark:border-dark-border/30 rounded-xl p-3 font-black text-text-primary dark:text-white focus:ring-2 focus:ring-yellow-warm transition-all outline-none\"\n                        />\n                      </div>\n                    )}\n\n                    {(settings.reminders.frequency || 'daily') === 'weekly' && (\n                      <div className=\"space-y-2\">\n                        <label className=\"text-[10px] font-black text-text-primary/60 dark:text-white/60 uppercase tracking-widest block\">\n                          Day of Week\n                        </label>\n                        <select\n                          value={settings.reminders.dayOfWeek ?? 0}\n                          onChange={handleDayOfWeekChange}\n                          className=\"w-full bg-bg-secondary dark:bg-dark-bg-primary/50 border border-border-soft dark:border-dark-border/30 rounded-xl p-3 font-black text-text-primary dark:text-white focus:ring-2 focus:ring-yellow-warm transition-all outline-none\"\n                        >\n                          <option value={0}>Sunday</option>\n                          <option value={1}>Monday</option>\n                          <option value={2}>Tuesday</option>\n                          <option value={3}>Wednesday</option>\n                          <option value={4}>Thursday</option>\n                          <option value={5}>Friday</option>\n                          <option value={6}>Saturday</option>\n                        </select>\n                      </div>\n                    )}\n\n                    {(settings.reminders.frequency || 'daily') === 'monthly' && (\n                      <div className=\"space-y-2\">\n                        <label className=\"text-[10px] font-black text-text-primary/60 dark:text-white/60 uppercase tracking-widest block\">\n                          Day of Month (1-31)\n                        </label>\n                        <input\n                          type=\"number\"\n                          min=\"1\"\n                          max=\"31\"\n                          value={settings.reminders.dayOfMonth ?? 1}\n                          onChange={handleDayOfMonthChange}\n                          className=\"w-full bg-bg-secondary dark:bg-dark-bg-primary/50 border border-border-soft dark:border-dark-border/30 rounded-xl p-3 font-black text-text-primary dark:text-white focus:ring-2 focus:ring-yellow-warm transition-all outline-none\"\n                        />\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Device Calendar Integration */}\n                  <div className=\"bg-bg-secondary dark:bg-dark-bg-primary/50 rounded-xl p-4 border border-border-soft dark:border-dark-border/30\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"space-y-1\">\n                        <p className=\"text-[10px] font-black text-text-primary dark:text-white uppercase tracking-widest\">\n                          Device Calendar\n                        </p>\n                        <p className=\"text-xs text-text-primary/60 dark:text-white/60\">\n                          Add reminders to your device's calendar app\n                        </p>\n                      </div>\n                      <button\n                        onClick={handleCalendarToggle}\n                        className={`w-14 h-8 rounded-full transition-all relative ${\n                          settings.reminders.useDeviceCalendar\n                            ? 'bg-yellow-warm'\n                            : 'bg-border-soft dark:bg-dark-bg-primary'\n                        }`}\n                      >\n                        <div className={`absolute top-1 w-6 h-6 bg-white rounded-full shadow-md transition-all ${\n                          settings.reminders.useDeviceCalendar ? 'right-1' : 'left-1'\n                        }`} />\n                      </button>\n                    </div>\n                  </div>\n\n                  {/* Ntfy.sh Push Notifications */}\n                  <div className=\"bg-bg-secondary dark:bg-dark-bg-primary/50 rounded-xl p-4 border border-border-soft dark:border-dark-border/30 space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"space-y-1\">\n                        <p className=\"text-[10px] font-black text-text-primary dark:text-white uppercase tracking-widest\">\n                          Push Notifications (ntfy.sh)\n                        </p>\n                        <p className=\"text-xs text-text-primary/60 dark:text-white/60\">\n                          Secure push notifications to your device\n                        </p>\n                      </div>\n                      <button\n                        onClick={handleNtfyToggle}\n                        className={`w-14 h-8 rounded-full transition-all relative ${settings.reminders.useNtfyPush ? 'bg-yellow-warm' : 'bg-border-soft dark:bg-dark-bg-primary'}`}\n                      >\n                        <div className={`absolute top-1 w-6 h-6 bg-white rounded-full shadow-md transition-all ${settings.reminders.useNtfyPush ? 'right-1' : 'left-1'}`} />\n                      </button>\n                    </div>\n                    \n                    {settings.reminders.useNtfyPush && (\n                      <div className=\"space-y-4 pt-3 border-t border-border-soft dark:border-dark-border/30\">\n                        {/* Topic Display */}\n                        <div className=\"bg-white dark:bg-dark-bg-primary rounded-xl p-4 border-2 border-yellow-warm/30 space-y-3\">\n                          <div className=\"flex items-center justify-between\">\n                            <p className=\"text-[9px] font-black text-text-primary dark:text-white uppercase tracking-widest\">\n                              Your Subscription Topic\n                            </p>\n                            <button\n                              onClick={handleResetTopic}\n                              className=\"px-2 py-1 bg-border-soft dark:bg-dark-bg-secondary text-text-primary dark:text-white rounded-lg text-[8px] font-black uppercase tracking-widest hover:bg-yellow-warm/20 dark:hover:bg-yellow-warm/20 transition-all\"\n                              title=\"Generate new topic\"\n                            >\n                              🔄 Reset\n                            </button>\n                          </div>\n                          <div className=\"bg-bg-secondary dark:bg-dark-bg-secondary rounded-lg p-3 border border-border-soft dark:border-dark-border/30\">\n                            <code className=\"text-sm font-black text-navy-primary dark:text-yellow-warm break-all\">\n                              {settings.reminders.ntfyTopic || 'Loading...'}\n                            </code>\n                          </div>\n                          <p className=\"text-[9px] text-text-secondary dark:text-white/70 leading-relaxed\">\n                            📱 <strong>Quick Setup:</strong> Open the ntfy app on your device and subscribe to this topic. That's it!\n                          </p>\n                        </div>\n\n                        {/* Test Button */}\n                        <button\n                          onClick={handleTestNtfy}\n                          disabled={testStatus === 'sending'}\n                          className={`w-full px-4 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all shadow-md ${\n                            testStatus === 'success' \n                              ? 'bg-calm-sage text-white' \n                              : testStatus === 'error'\n                              ? 'bg-warm-coral text-white'\n                              : testStatus === 'sending'\n                              ? 'bg-border-soft dark:bg-dark-bg-tertiary text-text-primary dark:text-white opacity-50 cursor-not-allowed'\n                              : 'bg-yellow-warm text-text-primary hover:opacity-90'\n                          }`}\n                        >\n                          {testStatus === 'sending' && '⏳ Sending...'}\n                          {testStatus === 'success' && '✅ Sent! Check your device'}\n                          {testStatus === 'error' && '❌ Failed. Check your topic'}\n                          {testStatus === 'idle' && '🔔 Test Notification'}\n                        </button>\n\n                        {/* Advanced Options - Collapsible */}\n                        <details className=\"group\">\n                          <summary className=\"cursor-pointer text-[9px] font-black text-text-primary/60 dark:text-white/60 uppercase tracking-widest hover:text-text-primary dark:hover:text-white transition-colors\">\n                            ⚙️ Advanced Options\n                          </summary>\n                          <div className=\"mt-3 space-y-3 pt-3 border-t border-border-soft dark:border-dark-border/30\">\n                            <div className=\"space-y-2\">\n                              <label className=\"text-[9px] font-black text-text-primary/60 dark:text-white/60 uppercase tracking-widest block\">\n                                Custom Topic (Optional)\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={settings.reminders.ntfyTopic || ''}\n                                onChange={handleNtfyTopicChange}\n                                placeholder=\"grounded-abc123xyz\"\n                                className=\"w-full p-2 rounded-lg bg-white dark:bg-dark-bg-primary border border-border-soft dark:border-dark-border/30 text-xs font-medium text-text-primary dark:text-white focus:ring-2 focus:ring-yellow-warm transition-all outline-none\"\n                              />\n                              <p className=\"text-[8px] text-text-primary/50 dark:text-white/50\">\n                                Use only letters, numbers, dashes, and underscores\n                              </p>\n                            </div>\n                            \n                            <div className=\"space-y-2\">\n                              <label className=\"text-[9px] font-black text-text-primary/60 dark:text-white/60 uppercase tracking-widest block\">\n                                Custom Server (Optional)\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={settings.reminders.ntfyServer || ''}\n                                onChange={(e) => onUpdateSettings({\n                                  ...settings,\n                                  reminders: { ...settings.reminders, ntfyServer: e.target.value.trim() || undefined }\n                                })}\n                                placeholder=\"https://ntfy.sh (default)\"\n                                className=\"w-full p-2 rounded-lg bg-white dark:bg-dark-bg-primary border border-border-soft dark:border-dark-border/30 text-xs font-medium text-text-primary dark:text-white focus:ring-2 focus:ring-yellow-warm transition-all outline-none\"\n                              />\n                              <p className=\"text-[8px] text-text-primary/50 dark:text-white/50\">\n                                Leave empty to use the free public server\n                              </p>\n                            </div>\n                          </div>\n                        </details>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Next Reminder Preview */}\n                  <div className=\"bg-yellow-warm/10 dark:bg-yellow-warm/20 rounded-xl p-4 border border-yellow-warm/30\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-[10px] font-black text-text-primary dark:text-white uppercase tracking-widest\">\n                        Next Reminder\n                      </span>\n                      <span className=\"text-sm font-black text-yellow-warm animate-pulse\">\n                        {nextPulseInfo}\n                      </span>\n                    </div>\n                  </div>\n                  \n                  <div className=\"w-full space-y-3\">\n                    {notifPermission !== 'granted' ? (\n                      <button \n                        onClick={requestPermission}\n                        className=\"w-full px-6 py-4 bg-yellow-warm/20 dark:bg-yellow-warm/20 text-yellow-warm dark:text-yellow-warm rounded-2xl text-[10px] font-black uppercase tracking-widest hover:bg-yellow-warm/30 dark:hover:bg-yellow-warm/30 transition-colors flex items-center justify-center gap-2\"\n                      >\n                        <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" /></svg>\n                        Enable Browser Permissions\n                      </button>\n                    ) : (\n                      <div className=\"px-6 py-4 bg-calm-sage/20 dark:bg-calm-sage/20 text-calm-sage dark:text-calm-sage rounded-2xl text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2\">\n                        <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M5 13l4 4L19 7\" /></svg>\n                        Nudge Engine Active\n                      </div>\n                    )}\n                  </div>\n                  <p className=\"text-[10px] text-text-tertiary dark:text-text-tertiary font-medium italic text-center\">\n                    Reminders trigger via system notifications while this tab is open. Keep the app open for notifications to work.\n                  </p>\n                </div>\n              </details>\n            )}\n\n            {/* AI Model - Collapsible */}\n            <details className=\"group border-t border-border-soft dark:border-dark-border pt-6\">\n              <summary className=\"cursor-pointer text-xs font-black text-text-primary dark:text-white uppercase tracking-widest mb-3 p-2 hover:bg-bg-secondary dark:hover:bg-dark-bg-secondary rounded-lg transition-colors list-none flex items-center justify-between\">\n                <span>AI Model</span>\n                <svg \n                  className=\"w-4 h-4 transition-transform group-open:rotate-180\" \n                  fill=\"none\" \n                  viewBox=\"0 0 24 24\" \n                  stroke=\"currentColor\"\n                >\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                </svg>\n              </summary>\n              <div className=\"mt-3 space-y-4\">\n                <p className=\"text-xs text-text-secondary dark:text-text-secondary\">\n                  Update the on-device AI model for better guidance and encouragement. Models are downloaded and cached on your device for privacy.\n                </p>\n                \n                {/* AI Diagnostics Component */}\n                <AIDiagnostics />\n                \n                {/* Model Selection */}\n                <div className=\"space-y-2\">\n                  <label className=\"text-xs font-bold text-text-primary dark:text-white\">\n                    Select AI Model:\n                  </label>\n                  <select\n                    value={selectedAIModel}\n                    onChange={async (e) => {\n                      const newModel = e.target.value as AIModelType;\n                      setSelectedAIModel(newModel);\n                      \n                      // Update settings\n                      if (onUpdateSettings && settings) {\n                        onUpdateSettings({\n                          ...settings,\n                          aiModel: newModel\n                        });\n                      }\n                      \n                      // Reload models with new selection\n                      setUpdatingModel(true);\n                      try {\n                        setSelectedModel(newModel);\n                        const success = await initializeModels(true, newModel);\n                        \n                        setTimeout(() => {\n                          const status = getModelStatus();\n                          setModelStatus(status);\n                        }, 1000);\n                        \n                        if (success) {\n                          console.log(`✅ Switched to ${getAllModelConfigs()[newModel].name}`);\n                        }\n                      } catch (error) {\n                        console.error('Model switch error:', error);\n                      } finally {\n                        setUpdatingModel(false);\n                      }\n                    }}\n                    disabled={updatingModel || modelStatus?.loading}\n                    className=\"w-full px-4 py-3 rounded-xl text-xs font-medium bg-bg-secondary dark:bg-dark-bg-secondary text-text-primary dark:text-white border border-border-soft dark:border-dark-border focus:outline-none focus:ring-2 focus:ring-navy-primary disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    {Object.entries(getAllModelConfigs()).map(([key, config]) => (\n                      <option key={key} value={key}>\n                        {config.name} - {config.description} ({config.size})\n                      </option>\n                    ))}\n                  </select>\n                  <p className=\"text-[10px] text-text-tertiary dark:text-text-tertiary\">\n                    {getAllModelConfigs()[selectedAIModel].description}. Models are cached in your browser for instant loading.\n                  </p>\n                </div>\n                \n                {/* Model Status Display */}\n                {modelStatus && (\n                  <div className=\"p-3 bg-bg-secondary dark:bg-dark-bg-secondary rounded-lg border border-border-soft dark:border-dark-border space-y-2\">\n                    <div className=\"flex items-center justify-between text-xs\">\n                      <span className=\"text-text-secondary dark:text-text-secondary\">Model Status:</span>\n                      <span className={`font-semibold ${modelStatus.loaded ? 'text-green-600 dark:text-green-400' : modelStatus.loading ? 'text-yellow-600 dark:text-yellow-400' : 'text-red-600 dark:text-red-400'}`}>\n                        {modelStatus.loaded ? '✓ Loaded' : modelStatus.loading ? '⏳ Loading...' : '✗ Not Available'}\n                      </span>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-2 text-[10px]\">\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-text-tertiary dark:text-text-tertiary\">Mood Tracker:</span>\n                        <span className={modelStatus.moodTracker ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'}>\n                          {modelStatus.moodTracker ? '✓' : '✗'}\n                        </span>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-text-tertiary dark:text-text-tertiary\">Counseling Coach:</span>\n                        <span className={modelStatus.counselingCoach ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'}>\n                          {modelStatus.counselingCoach ? '✓' : '✗'}\n                        </span>\n                      </div>\n                    </div>\n                    {!modelStatus.loaded && !modelStatus.loading && (\n                      <p className=\"text-[10px] text-text-tertiary dark:text-text-tertiary mt-2\">\n                        The app is using rule-based responses. This is normal if your browser doesn't support ONNX Runtime. All features remain fully functional.\n                      </p>\n                    )}\n                  </div>\n                )}\n                \n                <button\n                  onClick={async () => {\n                    if (confirm('This will clear and re-download the AI model. This may take a few minutes and requires internet connection. Continue?')) {\n                      setUpdatingModel(true);\n                      try {\n                        const { initializeModels } = await import('../services/aiService');\n                        const success = await initializeModels(true); // Force reload\n                        \n                        // Update status after loading\n                        setTimeout(() => {\n                          const status = getModelStatus();\n                          setModelStatus(status);\n                        }, 1000);\n                        \n                        if (success) {\n                          alert('✅ Model update complete! The new model has been downloaded and cached on your device. AI features are now available.');\n                        } else {\n                          const status = getModelStatus();\n                          let message = 'Model update failed. The app will continue using rule-based responses.';\n                          if (!status.moodTracker && !status.counselingCoach) {\n                            message += '\\n\\nThis is likely a browser compatibility issue with ONNX Runtime. The app is fully functional with rule-based responses.';\n                          } else if (!status.moodTracker || !status.counselingCoach) {\n                            message += `\\n\\nPartial loading: ${status.moodTracker ? 'Mood tracker ✓' : 'Mood tracker ✗'}, ${status.counselingCoach ? 'Counseling coach ✓' : 'Counseling coach ✗'}`;\n                          }\n                          alert(message);\n                        }\n                      } catch (error: any) {\n                        console.error('Model update error:', error);\n                        const errorMsg = error?.message || String(error);\n                        let message = 'Error updating model. ';\n                        if (errorMsg.includes('registerBackend') || errorMsg.includes('ort-web')) {\n                          message += 'This appears to be a browser compatibility issue with ONNX Runtime. The app will continue using rule-based responses, which are fully functional.';\n                        } else {\n                          message += 'Please check your internet connection and try again.';\n                        }\n                        alert(message);\n                      } finally {\n                        setUpdatingModel(false);\n                      }\n                    }\n                  }}\n                  disabled={updatingModel || modelStatus?.loading}\n                  className={`w-full px-4 py-3 rounded-xl text-xs font-black uppercase tracking-widest shadow-sm border ${\n                    updatingModel || modelStatus?.loading\n                      ? 'bg-gray-400 dark:bg-gray-600 text-white cursor-not-allowed'\n                      : 'bg-navy-primary text-white dark:text-white hover:opacity-90 border-navy-primary'\n                  }`}\n                >\n                  {updatingModel ? '⏳ Updating...' : modelStatus?.loading ? '⏳ Loading...' : 'Update AI Model'}\n                </button>\n                <p className=\"text-[9px] text-text-tertiary dark:text-text-tertiary text-center\">\n                  Recommended: MiniCPM-0.5B or TinyLlama-1.1B (quantized for mobile)\n                </p>\n                {!modelStatus?.loaded && !modelStatus?.loading && (\n                  <p className=\"text-[9px] text-text-tertiary dark:text-text-tertiary text-center italic\">\n                    Note: If models fail to load, this is typically a browser compatibility issue. The app remains fully functional with rule-based responses.\n                  </p>\n                )}\n              </div>\n            </details>\n          </div>\n\n          <div className=\"flex gap-3 pt-4\">\n            <button\n              onClick={onClose}\n              className=\"flex-1 px-6 py-4 bg-bg-secondary dark:bg-dark-bg-secondary text-text-primary dark:text-white rounded-2xl text-xs font-black uppercase tracking-widest hover:bg-bg-tertiary dark:hover:bg-dark-bg-tertiary\"\n            >\n              Cancel\n            </button>\n            <button\n              onClick={handleSave}\n              className=\"flex-1 px-6 py-4 bg-navy-primary text-white rounded-2xl text-xs font-black uppercase tracking-widest hover:opacity-90 shadow-sm\"\n            >\n              Save Configuration\n            </button>\n          </div>\n\n          <div className=\"pt-4 border-t border-border-soft dark:border-dark-border\">\n            <p className=\"text-xs text-text-tertiary dark:text-text-tertiary text-center\">\n              This configuration helps the app support your therapy integration. All AI processing happens on your device for privacy.\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {showEmailSchedule && settings && onUpdateSettings && (\n        <EmailScheduleComponent\n          schedule={settings.emailSchedule}\n          onUpdate={(schedule) => onUpdateSettings({ ...settings, emailSchedule: schedule })}\n          onClose={() => setShowEmailSchedule(false)}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default LCSWConfigComponent;\n\n"],"file":"assets/LCSWConfig-CDUAZG3u.js"}